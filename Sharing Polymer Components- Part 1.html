<h1>Compartilhando Componentes do Polymer: Parte 1</h1>

<p>Em meu <a href="http://code.tutsplus.com/tutorials/using-polymer-to-create-web-components--cms-20475">último artigo sobre a biblioteca Polymer</a>, expliquei como aproveitar essa ótima ferramente para criar componentes web reutilizáveis. O ponto central do tutorial, bem como do uso de componentes, é ajudar nosso desenvolvimento através:</p>

<ul>
<li>Do encapsulamento da complexidade dos código e estrutura</li>
<li>Da possibilidade dos desenvolvedores usarem convenções de nomeação simples como as tags</li>
<li>Do fornecimento de elementos de Interface de Usuário (UI) para se usar e estender</li>
</ul>

<p>Estou bastante interessado por ela e quis explorar um pouco mais, verificando o novo modelo que a equipe do Polymer lançou para facilitar o desenvolvimento e reutilização de componentes, substancialmente, mais fácil.</p>

<h2>O Caminho Canônico</h2>

<p>Uma das peculiaridades do processo de desenvolvimento do Polymer que eu ainda não trabalhei foi o do rompimento entre o desenvolvimento do componente e a conseguir toná-lo disponível para reuso por outros. Vejamos um pequeno trecho do meu tutorial anterior:</p>

<pre class="brush: html">&lt;link rel="import" href="../bower_components/polymer/polymer.html"&gt;</pre>

<p>O propósito desse trecho de código é o de incluir o códibo base do Polymer, a API principal que permitirá você definir elementos customizáveis. Para desenvolvimento local e de testes, isso funciona perfeitamente, mas, infelizmente, o caminho especificado prevenirá você de compartilhar esse componente. A razão disso é que, se outra pessoa tentar instalar seu componente usando o <a href="http://bower.io/">Bower</a> (que é o meio preferido de instalação), ele acabará como irmão do Polymer, dentro do diretório <code>bower_components</code>.</p><p>O problema disso é que o componente procurará por <code>../bower_components/polymer/polymer.html</code>, que será um caminho inválido. Os componente sempre assumem que suas dependências são irmãs, então, ele deveria procurar, na verdade, por <code>../polymer/polymer.html</code>. Esse é o "caminho canônino".</p>

<p>Conversando com o super <a href="https://twitter.com/rob_dodson">Rob Dodson</a> da equipe do Polymer, ele disse que a única maneira de contornar isso era desenvolver da maneira que mostrei primeiro e, quando eu estivesse pronto para compartilhar meu componente, converter todos os meus caminhos de <code>bower_components</code> para <code>../</code>. </p>

<p>Isso, obviamente, não é ideal e eu, provavelmente, poderia ter criado alguma tarefa no Grunt para analisar meus componentes e fazer essas atualizações. Felizmente, a equipe do Polymer esteve ocupada nesse problema e apresentou uma solução criativa que eles chamam de <code>untitled-element</code>.</p>

<h2>O Modelo <code>untitled-element</code></h2>

<p>Quando falo do <code><a href="https://github.com/PolymerLabs/untitled-element">untitled-element</a></code>, refiro-me a um novo modelo base que está disponível para criarmos, de forma substancialmente mais fácil, componentes reusáveis e implementáveis, tendo uma base sólida que possamos trabalhar. Esse modelo ajuda a eliminar os problemas mencionados acima, ao:</p>

<ul>
<li>Prover um estrutura adequada de diretórios;</li>
<li>Incorporar um componente adicional que serve para documentar sua API;</li>
<li>Permitir que demonstre, facilmente, seu componente enquanto desenvolve <em>e</em> quando compartilha</li>
</ul>

<p>A grande vantagem disso é que sermos capazes de desenvolver um componente sem ter que passar pelo problema alterar os caminhos nos arquivo que, além de ser bem chato, podem fazer seu componente deixar de funcionar se esquecer algo.</p>

<p>Atualmente, o projeto faz parte do <a href="https://github.com/PolymerLabs/">PolymerLabs</a> enquanto ele é posto à prova em testes, mas, certamente, já é bem promissor:</p><figure class="post_image"><img alt="" src="https://s3.amazonaws.com/cms-assets.tutsplus.com/uploads/users/45/posts/21264/image/github.png"></figure>

<p>Agora, a primeira coisa que você fará é criar um diretório de desenvolvimento que guardará seu novo componente, bem como todos os componentes do Bower que você instalará. Nomeei o meu de <code>polymerdev</code>. Daqui, você precisará ir até o repositório no GitHub do <code><a href="https://github.com/PolymerLabs/untitled-element">untitled-element</a></code> e baixá-lo em seu próprio diretório de desenvolvimento. Essa passo é bastante importante porque você <em>precisa</em> extrair o conteúdo dentro daquele diretório para evitar os problemas de diretórios irmão, como mencionado mais cedo. </p>

<p>Extrair o arquivo <code>.zip</code> criará um novo diretório chamado <code>untitled-element-master</code> que contem os arquivos base para você criar seu novo componente. Você precisará renomear algumas coisas, com base no nome do seu componente. Isso inclui:</p>

<ul>
<li>O diretório <code>untitled-element-master</code></li>
<li><code>untitled-element.html</code></li>
<li><code>untitled-element.css</code></li>
</ul>

<p>Recriarei o elemento Reddit que criei em meu último tutorial, assim, essas serão as mudanças que faremos nos locais especificados acima:</p>

<ul>
<li><code>untitled-element-master</code> -&gt; <code>reddit-element</code></li>
<li><code>untitled-element.html</code> -&gt; <code>reddit-element.html</code></li>
<li><code>untitled-element.css</code> -&gt; <code>reddit-element.css</code></li>
</ul>

<p>É assim que a estrutura de diretórios era antes:</p><figure class="post_image"><img alt="" src="https://s3.amazonaws.com/cms-assets.tutsplus.com/uploads/users/45/posts/21264/image/directory.png"></figure>

<p>E é assim que ela está, após as atualizações:</p><figure class="post_image"><img alt="" src="https://s3.amazonaws.com/cms-assets.tutsplus.com/uploads/users/45/posts/21264/image/directory-new.png"></figure>

<p>A chave para entender é que você trabalhará dentro do diretório <code>reddit-element</code> ao criar seu componente e, futuramente, ao usar o Bower para instalar os componentes do Polymer, esse diretório será um irmão direto aos diretórios recém instalados. Sei que estou insistindo nisso, mas é importante entedê-lo, uma vez que afeta toda a capacidade de compartilhar seu componente.</p>

<p>Para finalizar, você quererá atualizar as referências em relação ao nome do seu componente, dentro dos seguintes arquivos:</p>

<ul>
<li><code>bower.json</code></li>
<li><code>demo.html</code></li>
<li><code>reddit-element.html</code></li>
</ul>

<p>Cada um desses elementos faz referências ao <code>untitled-element</code> dentro de seus códigos e precisam ser atualizados. Lembre-se que todas e quaisquer referências a <code>untitled-element</code> devem ser substituídas por <code>reddit-element</code>. Se quiser certificar-se totalmente, faça uma busca e substituição global, usando seu editor de preferência.</p>

<h2>Preparando o Bower</h2>

<p>Uma vez que o Bower é o método preferido para instalar e compartilhar componente do Polymer, é interessante garantirmos que a configuração do Bower para nosso componente Reddit esteja correta.</p>

<p>Por padrão, o código base inclui um arquivo <code>bower.json</code>. Esse arquivo é usado para listar diversas coisas, incluindo o nome do componente e quaisquer dependências que precisam ser instaladas para usá-lo. Eis como ele parece:</p>

<pre class="brush: javascript">{
  "name": "reddit-element",
  "private": true,
  "dependencies": {
    "polymer": "Polymer/polymer#master"
  }
}
</pre>

<p>Primeiro, removerei a propriedade <code>private</code>, uma vez que ela prevenirá que o componente seja listado na Listagem do Bower. Uma vez que ele deve ser compartilhável, queremos que ele seja listado. O componente Reddit também precisa realizar chamadas Ajax, então, adicionarei uma dependência relacionada ao Polymer, e ao <code><a href="https://github.com/Polymer/core-elements">core-elements</a></code>, um conjunto de componentes que inclui uma funcionalidade Ajax que precisaremos. Finalmente, adicionarei o número de versão do componente, para acompanhá-lo. E o arquivo ficará assim:</p>

<pre class="brush: javascript">{
  "name": "reddit-element",
  "version": "0.0.1",
  "dependencies": {
    "polymer": "Polymer/polymer#~0.2.3",
    "core-elements": "Polymer/core-elements#~0.2.3",
  }
}</pre>

<p>A última parte da configuração do Bower que precisa ser feita, é criar um arquivo chamado <code><a href="http://bower.io/#custom-install-directory">.bowerrc</a></code> no diretório <code>reddit-element</code>, que define um local customizado de instalação para as dependências de nosso componente. Ele é definido como um arquivo JSON de dados, como esse:</p>

<pre class="brush: javascript">{
   "directory": "../"
}</pre>

<p>O que ele faz é dizer ao Bower para instalar quaisquer dependências um level acima, tornando-as irmãs do diretório <code>reddit-element</code>. Fazer isso é importante porque, quando alguém instalar nosso componente com o Bower, ele será colocado dentro do diretório <code>bower_components</code> como irmão de tudo que está lá dentro (includindo o Polymer). Estruturando as coisas dessa forma, garante que estamos desenvolvendo da mesma forma que iremos compartilhar. Isso também permite que usemos o caminho canônico, mencionado anteriormente, garantindo uma forma consistente de referência outros componentes em nosso código. </p>

<p>Revisemos as diferenças. Se não tivesse criado o arquivo <code>.bowerrc</code> e tivesse executado o comando <code>bower install</code>, minha estrutura de diretório estaria assim:</p><figure class="post_image"><img alt="" src="https://s3.amazonaws.com/cms-assets.tutsplus.com/uploads/users/45/posts/21264/image/bower-norc.png"></figure>

<p>Ela instalaria o diretório <code>bower_components</code> diretamente dentro do diretório dos componentes, o que não é o que quero. Quero que o diretório <code>reddit-element</code> seja irmão de todas as ddependências que ele precisa:</p><figure class="post_image"><img alt="" src="https://s3.amazonaws.com/cms-assets.tutsplus.com/uploads/users/45/posts/21264/image/bower-rc.png"></figure>

<p>Esse método garante que, quando um usuário instalar esse componente usando o Bower, o componente e suas dependências será instaladas, apropriadamente, dentro do diretório <code>bower_components</code>.</p>

<p>Com o arquivo <code>.bowerrc</code> adicionado ao diretório de nosso componente e o arquivo <code>bower.json</code> preparado com as dependências apropriadas, o próximo passo é executar o comando <code>bower install</code>, para fazer com que o Bower baixe os componentes apropriados, adicionando-os ao projeto.</p>

<h2>No Próximo Tutorial</h2>

<p>Nesse tutorial, quis garantir uma base sólida sobre como usar o novo modelo base de componente do Polymer e um pouco da teoria em relação às escolhas que a equipe do Polymer tomou. </p>

<p>Na próxima parte da série, trateri sobre o novo componente de documentação que vem incluso com o modelo base de componente, e como ele tornará o compartilhamento de seu componente muito mais fácil. Também mostrarei como preparar seu componente para ser compartilhado pela Listagem do Bower.</p>
