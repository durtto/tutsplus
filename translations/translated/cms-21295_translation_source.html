<h1>50 Filtros para WordPress: Os 10 Primeiros Filtros</h1>

<p>No primeiro artigo desta série, apresentamos a ideia do mundo dos filtros dentro do contexto do WordPress. Neste tutorial, começaremos a revisar os 50 filtros selecionados, explicando o que eles fazem, além de ver um exemplo de cada filtro.</p>

<p>Então, sem mais delongas, eis a primeira leva dos nossos 50 filtros!</p>

<h2>Alterando As Mensagens Padrão de Erro de Login</h2>

<p>O WordPress dá muita informação ao apresentar as mensagens de erro de login: "A senha que você digitou para o usuário <strong>barisunver</strong> está incorreta". Isso significa que hackers poderiam tentar nomes de usuários diferentes para descobrir qual nome de usuário usamos. Graças a esse filtro, você pode desabilitar esse tipo de mensagem.</p>

<h3>Exemplo: Corrigindo o "Problema de Muita Informação"</h3>

<p>Que tal mudarmos todas as mensagens de erros para uma cadeia de caracteres vazia, prevenindo que hackers descubram informações sobre nossas credenciais?</p>

<pre class="brush: php">&lt;?php

add_filter( 'login_errors', 'login_errors_example' );

function login_errors_example( $error ) {
	$error = '';
	return $error;
}

?&gt;</pre>

<p>Agora, sim. Muito melhor.</p>

<h2>Redirecionando Comentaristas para Outra Página</h2>

<p>Após publicar um comentário no WordPress, você permanece na mesma página. Sim, é a coisa mais lógica a se fazer, mas, você sabia que você pode redirecionar seus comentaristas para outra página, uma vez que seus comentários tenham sido publicados com sucesso? O filtro <code>comment_post_redirect</code> nos permite fazer isso e tenho o exemplo perfeito para esse tipo de filtro!</p>

<h3>Exemplo: Redirecionar o Usuário para Página de Cadastro Após Comentário Bem Sucedido</h3>

<p>Há uma chance maior dos comentaristas "seguirem" seu blog por novos artigos, certo? Se os direcionarmos para uma página com "Obrigado pelo seu comentário! Você gostaria de se cadastrar no meu blog?", poderíamos transformar esses comentaristas em inscritos/clientes! E é bem fácil de fazer isso, com a ajuda do nosso filtro <code>comment_post_redirect</code>:</p>

<pre class="brush: php">&lt;?php

add_filter( 'comment_post_redirect', 'comment_post_redirect_example' );

function comment_post_redirect_example( $location ) {
	return '/obrigado-pelo-comentario/';
}

?&gt;</pre>

<p>Perceba que o WordPress usa a função <code>wp_safe_redirect()</code>, implicando que você deve usar uma página local ou uma página em servidores permitidos (veja o filtro <code>allowed_redirect_hosts</code> mais abaixo).</p>

<h2>Permitindo Redirecionamento Externo para a Função <code>wp_safe_redirect()</code></h2>

<p>Por padrão, a função <code>wp_safe_redirect()</code> não permite redirecionamento para páginas externas. Mas podemos alterar esse comportamento e especificar um servidor externo usando este filtro.</p>

<h3>Exemplo: Permitindo Redirecionamentos de Subdomínios</h3>

<p>Uma vez que a função <code>wp_safe_redirect()</code> só permite redirecionamentos dentro da instalação do WordPress, subdomínios do seu domínio estão além dos limites, também. </p>

<p>Façamos com que o WordPress também possa usá-los:</p>

<pre class="brush: php">&lt;?php

add_filter( 'allowed_redirect_hosts', 'allowed_redirect_hosts_example' );

function allowed_redirect_hosts_example( $content ) {
	$content[] = 'forum.meusite.com';
	$content[] = 'bemvindo.meusite.com';
	$content[] = 'ajuda.meusite.com';
	return $content;
}

// Código Fonte de Exemplo: http://codex.wordpress.org/Plugin_API/Filter_Reference/allowed_redirect_hosts

?&gt;</pre>

<h2>Adicionando Classes à <em>Tag</em> <code>&lt;body&gt;</code></h2>

<p>A função <code>body_class()</code> é <em>maravilhosa</em>. Ela provê classes diferentes para a <em>tag</em> <code>body</code> em páginas diferentes, assim você pode usar seu CSS de forma mais efetiva. E com o filtro homônimo, <code>body_class</code>, você pode adicionar ou remover classes.</p>

<h3>Exemplo: Adicionando Classes de Categoria às <em>Tags</em> <code>&lt;body&gt;</code> de Páginas de Artigos</h3>

<p>Se precisar de estilos diferentes para cada uma das suas categorias, o filtro <code>body_class</code> pode ajudar você, adicionando classes com os nomes das categorias à <em>tag</em> <code>body</code> das páginas de artigos. </p>

<p>E é assim que se faz:</p>

<pre class="brush: php">&lt;?php

add_filter( 'body_class', 'body_class_example' );

function body_class_example( $classes ) {
	if( is_single() ) {
		foreach( get_the_category( get_the_ID() ) as $category )
			$classes[] = 'cat-' . $category-&gt;category_nicename;
	}
	return $classes;
}

// Código Fonte de Exemplo: https://codex.wordpress.org/Function_Reference/body_class#Add_Classes_By_Filters

?&gt;</pre>

<p>Se você tem uma categoria chamada "Programação", você poderá usar a classe <code>.cat-programacao</code> para estilizar os posts na categoria "Programação".</p>

<h2>Alterando a Localização</h2>

<p>O WordPress é o sistema de gerenciamento de conteúdo (CMS) número 1 do mundo porque ele nos permite traduzir praticamente todos os textos existentes nele. E o filtro <code>locale</code> nos permite configurar a localização de nossa instalação WordPress.</p>

<h3>Exemplo: Alterando o Idioma de um Site com um Parâmetro de URL</h3>

<p>Se você possuir um site multilíngue, uma solução fácil para adicionar uma forma de alterar o idioma seria usar um parâmetro de URL, dessa forma abaixo:</p>

<pre class="brush: php">&lt;?php

add_filter( 'locale', 'locale_example' );

function locale_example( $lang ) {
	if ( 'us' == $_GET['language'] ) {
		return 'en_US';
	} else {
		return $lang;
}
}

// Código Fonte de Exemplo: http://codex.wordpress.org/Plugin_API/Filter_Reference/locale

?&gt;</pre>

<p>Agora, quando configurar o parâmetro de URL assim <code>mywebsite.com/?language=tr</code>, a localização do seu site será alterada para Inglês dos Estados Unidos. Não serve para o conteúdo do artigo, claro, mas já é um começo.</p>

<h2>Filtragem de Limpeza de Nomes de Usuário</h2>

<p>O WordPress limpa os nomes de usuários com uma função de limpeza chamada <code>sanitize_user()</code>. Com o filtro de mesmo nome, você pode customizar essa função.</p>

<h3>Exemplo: Aceitar Nomes de Usuário Somente em Minúsculo</h3>

<p>Se não quiser aceitar nomes de usuário que contenham letras maiúsculas (independentemente de ser "SHOUTINGBOY88" ou "CrazyGirl92"), você pode usar a função <code>strtolower</code> do PHP e atrelá-la ao filtro <code>sanitize_user</code>, como logo abaixo:</p>

<pre class="brush: php">&lt;?php

add_filter( 'sanitize_user', 'strtolower' );

// Código Fonte de Exemplo: http://codex.wordpress.org/Plugin_API/Filter_Reference/sanitize_user

?&gt;</pre>

<p>Provavelmente, esse é um dos filtros mais fáceis desta série.</p>

<h2>Filtrando o Conteúdo do Artigo</h2>

<p>Esse filtro não requer muita apresentação: O filtro <code>the_content</code> nos permite alterar o conteúdo do artigo.</p>

<h3>Exemplo: Removendo As <em>Tags</em> <code>&lt;p&gt;</code> que Envolvem as Imagens</h3>

<p>O WordPress não nos permite mostrar imagens fora de parágrafos - ele as envolve automaticamente em uma <em>tag</em> <code>&lt;p&gt;</code>, que, para mim, é bem irritante. Se você também se irrita com esse comportamento, você pode remover essas <em>tags</em> <code>&lt;p&gt;</code> com a ajuda desse pequeno trecho de código:</p>

<pre class="brush: php">&lt;?php

add_filter( 'the_content', 'the_content_example' );

function the_content_example( $content ) {
	return preg_replace('/&lt;p&gt;\s*(&lt;a .*&gt;)?\s*(&lt;img .* \/&gt;)\s*(&lt;\/a&gt;)?\s*&lt;\/p&gt;/iU', '\1\2\3', $content);
}

// Código Fonte de Exemplo: http://wpsnipp.com/index.php/functions-php/remove-p-tag-from-around-images-in-the_content/

?&gt;</pre>

<h2>Filtrando Formulários de Artigos Protegidos por Senha</h2>

<p>Para artigos protegidos por senhas, o WordPress substitui o conteúdo do artigo por um formulário para a senha, de forma automática. Com o filtro <code>the_password_form</code>, você pode editar esse formulário.</p>

<h3>Exemplo: Simplificando o Formulário de Senha</h3>

<p>Se você costuma usar artigos protegidos por senhas no seu site WordPress e não precisa do texto "Esse conteúdo é protegido por senha. Para visualizá-lo, digite a senha abaixo:", você pode simplificar o formulário com a ajuda do trecho de código abaixo:</p>

<pre class="brush: php">&lt;?php

add_filter( 'the_password_form', 'the_password_form_example' );

function the_password_form_example() {
	$output  = '&lt;form action="' . esc_url( site_url( 'wp-login.php?action=postpass', 'login_post' ) ) . '" method="post"&gt;';
	$output .= '&lt;span&gt;' . __( "Digite a Senha:" ) . ' &lt;/span&gt;';
	$output .= '&lt;input name="post_password" type="password" size="20" /&gt;';
	$output .= '&lt;input type="submit" name="Submit" value="' . esc_attr__( "Acessar" ) . '" /&gt;';
	$output .= '&lt;/form&gt;';
	return $output;
}

// Código Fonte de Exemplo: http://codex.wordpress.org/Using_Password_Protection#Password_Form_Text

?&gt;</pre>

<p>E é isso. Agora, só temos três palavras, um campo de senha e um botão de enviar os dados, tudo numa única linha.</p>

<h2>Filtrando a Função <code>the_terms()</code></h2>

<p>Se você não está satisfeito com o retorno da função <code>the_terms()</code>, ou simplesmente quer usá-la para um propósito diferente, você pode usar o filtro homônimo: <code>the_terms</code>.</p>

<h3>Exemplo: Remover <em>Tags</em> HTML da Função <code>the_terms()</code></h3>

<p>Alguns anos atrás, precisei transformar as <em>tags</em> dos meus posts em texto simples. Passei várias e várias horas procurando alguma solução. No fim das contas, tinha uma extremamente simples:</p>

<pre class="brush: php">&lt;?php

add_filter( 'the_terms', 'strip_tags' );

?&gt;</pre>

<p>Você não imagina a minha cara quando descobri que poderia usar uma função padrão do PHP com o filtro <code>the_terms</code>.</p>

<h2>Alterando o Endereço de E-mail Usado para Envios de E-mail do seu Site</h2>

<p>Quando o WordPress envia e-mails para você ou para os membros do seu site, ele usa um endereço de e-mail parecido com isso <code>wordpress@seusite.com</code>. Com esse filtro, você pode alterá-lo.</p>

<h3>Exemplo: Configurando seu Próprio Endereço de E-mail para o Endereço de E-mail do Remetente</h3>

<p>Com uma função retornando apenas um e-mail diferente, você poderá alterar o endereço do remetente facilmente:</p>

<pre class="brush: php">&lt;?php

add_filter( 'wp_mail_from', 'wp_mail_from_example' );

function wp_mail_from_example( $email ) {
	return 'meu.endereco.de.email@meusite.com';
}

?&gt;</pre>

<p>Você pode usá-lo junto do filtro <code>wp_mail_from_name</code>: Mesma lógica, apenas crie uma função que retorna outra cadeia de caracteres, dessa vez, para o nome do remetente e anexe-a ao filtro <code>wp_mail_from_name</code>.</p>

<h2>Resumo de Hoje</h2>

<p>Vimos os primeiros 10 filtros nesse artigo. Espero que tenha gostado e aprendido alguns truques. Até o próximo artigo!</p>

<p>Ah! Gostaria de saber o que você achou, também. O que você achou dos filtros? Deixe seu comentário abaixo e, se tiver curtido o artigo, não deixe de compartilhá-lo!</p>