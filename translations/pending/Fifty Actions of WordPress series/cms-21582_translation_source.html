<h1>50 Ações Para WordPress – 50 Exemplos (41 a 50)</h1>

<p>Se você tem nos acompanhado pela série, então você já sabe que esse é o penúltimo artigo, sendo que é o último apresentando as 50 ações para WordPress. Para aqueles que acabaram de descobrir a série, aconselho ler o <a href="https://code.tutsplus.com/tutorials/fifty-actions-of-wordpress-50-examples-31-to-40--cms-21581" rel="external" target="_blank">artigo anterior</a> (já que este continua de onde esse terminou), bem como os artigos anteriores interligados.</p>

<p>Isso deixará você a par de tudo o que já fizemos e pronto para este.</p>

<p>É hora de começar!</p>

<h2>Manipulando o Elemento <code>&lt;head&gt;</code> das Páginas Administrativas de <em>Plugins</em></h2>

<p>Os <em>plugins</em> também tem necessidades: Eles precisam de <em>scripts</em> e estilos para suas próprias páginas. Com a ação <code>admin_head-(pagina_do_plugin)</code>, é possível injetar coisas no elemento <code>&lt;head&gt;</code> de páginas de <em>plugins</em> específicos.</p>

<h3>Adicionando Estilos às Páginas de Administração do Seu <em>Plugin</em></h3>

<p>Se você precisar adicionar algum estilo CSS à página de opções do seu <em>plugin</em>, o trecho de código abaixo ajudará nisso:</p>

<pre class="brush: php">&lt;?php

add_action( 'admin_head-ferramentas_de_pagina_meuplugin/meuplugin', 'admin_head_plugin_page_example' );

function admin_head_plugin_page_example() {
echo '&lt;style type="text/css"&gt;'
       . '/* seu estilo aqui */'
       . '&lt;/style&gt;';
}

// Código Fonte de Exemplo: http://codex.wordpress.org/Plugin_API/Action_Reference/admin_head-(plugin_page)

?&gt;</pre>

<p>Altere a linha comentada com o seu código CSS, substitua a segunda parte do nome da ação (<code>ferramentas_de_pagina_meuplugin/meuplugin</code>) com o nome do seu próprio <em>plugin</em> e pronto!</p>

<h2>Lidando com <em>Pings</em> Antes De Serem Processados</h2>

<p>"<em>Pings</em>" são uma das funcionalidades mais antigas do WordPress e a ação <code>pre_ping</code> permite-nos manipular os <em>pings</em> antes deles serem processados.</p>

<h3>Desabilitando Auto-<em>Pings</em></h3>

<p>O WordPress não diferencia <em>links</em> internos de externos, quando se trata de <em>pings</em>. Para desabilitar os auto-<em>pings</em>, utilize o trecho de código abaixo:</p>

<pre class="brush: php">&lt;?php

add_action( 'pre_ping', 'pre_ping_example' );
function pre_ping_example( &amp;$links ) {

	foreach ( $links as $l =&gt; $link ) {

        if ( 0 === strpos( $link, get_home_url() ) ) {
            unset( $links[ $l ] );
        }

	}

}

// Código Fonte de Exemplo: http://wpdevsnippets.com/remove-slef-pings/

?&gt;</pre>

<p>De agora em diante, sua instalação WordPress não fará <em>pings</em> de suas próprias publicações.</p>

<h2>Manipulando a Função <code>get_header()</code></h2>

<p>A ação <code>get_header</code> é invocada quando o modelo chama a função <code>get_header()</code>, tornando-a perfeita para funções que modificam o <em>frontend</em> dos cabeçalhos de páginas no WordPress.</p>

<h3>Ativando Um Simples Modo de Manutenção</h3>

<p>Se estiver com pressa e não tem tempo de instalar e configurar um <em>plugin</em> de "modo de manutenção", você pode usar o trecho de código abaixo e lançar um erro com <code>wp_die()</code> para todo mundo, exceto administradores:</p>

<pre class="brush: php">&lt;?php

add_action( 'get_header', 'get_header_example' );

function get_header_example() {

	if ( ! current_user_can( 'activate_plugins' ) ) {
		wp_die( 'The website will be back soon.' );
}

}

// Código Fonte de Exemplo: http://wp-snippets.com/articles/7-code-snippets-you-should-use-on-every-site/

?&gt;</pre>

<p>Como só administradores (e super administradores) tem a regra <code>'activate_plugins'</code>, o site será desligado para todo mundo, exceto administradores.</p>

<h2>Alterando o Elemento <code>&lt;head&gt;</code> da Página de <em>Login</em></h2>

<p>A ação <code>login_head</code> ajuda-nos a controlar o elemento <code>&lt;head&gt;</code> da página de login.</p>

<h3>Removendo o Efeito de "Tremer" para Credenciais Incorretas</h3>

<p>Se você não gosta que o formulário "trema" toda vez que um usuário submete credenciais incorretas, você pode usar a função abaixo para removê-lo:</p>

<pre class="brush: php">&lt;?php

add_action( 'login_head', 'login_head_example' );
function login_head_example() {
remove_action( 'login_head', 'wp_shake_js', 12 );
}

// Código Fonte de Exemplo: http://wordpress.org/support/topic/plugin-simplemodal-login-remove-shake-effect

?&gt;</pre>

<p>Bom, eu gosto desse efeito, mas...</p>

<h2>Manipulando o Rodapé do Painel</h2>

<p>Em algum momento, podemos querer ter controle sobre o rodapé dos painéis administrativos – não a seção do rodapé em si, mas aquela parte anterior à <em>tag</em> <code>&lt;/body&gt;</code>. A ação <code>admin_footer</code> serve para isso.</p>

<h3>Adicionando Estilos para Estados de Publicações</h3>

<p>Possuir uma paleta de cores consistente é um dos motivos do painel administrativo do WordPress ser tão bonito, mas não vejo problema algum em adicionar alguns padrões de cores para algo que precisa ser visto separadamente – como os estados das publicações. </p>

<p>Se você for como eu e quer distinguir postagens publicadas dos rascunhos e de outros tipos de publicações, uso o trecho abaixo:</p>

<pre class="brush: php">&lt;?php

add_action( 'admin_footer', 'admin_footer_example' );
function admin_footer_example() {

	echo '&lt;style type="text/css"&gt;
	.status-draft	{ background-color: #FCE3F2; }
	.status-pending	{ background-color: #87C5D6; }
	.status-future	{ background-color: #C6EBF5; }
	.status-private	{ background-color: #F2D46F; }
	&lt;/style&gt;';

}

// Código Fonte de Exemplo: http://wpsnipp.com/index.php/functions-php/change-admin-postpage-color-by-status-draft-pending-published-future-private/

?&gt;</pre>

<h2>Registrando <em>Scripts</em> e Estilos na Página de <em>Login</em></h2>

<p>Podemos registrar arquivos para o <em>frontend</em> com a função <code>wp_enqueue_scripts</code> e podemos registrar arquivos para o <em>backend</em> com a função <code>admin_enqueue_scripts</code>. E para a página de <em>login</em>? Você acertou: É hora do gancho <code>login_enqueue_scripts</code>!</p>

<h3>Alterando o Logo Acima do Formulário de <em>Login</em></h3>

<p>Eu gosto do logo do WordPress, mas não acho que ele deva ser mostrado toda vez que os usuários forem acessar o painel do meu site. Se você concorda comigo, você pode substituir a logo do WordPress pela sua própria, usando esse útil trecho abaixo:</p>

<pre class="brush: php">&lt;?php

add_action( 'login_enqueue_scripts', 'login_enqueue_scripts_example' );
function login_enqueue_scripts_example() {

	echo '&lt;style type="text/css"&gt;'
			. '#login h1 a {'
				. 'background-image: url(' . get_bloginfo( 'template_directory' ) . '/images/login-logo.png);'
				. 'padding-bottom: 30px;'
			. '}'
		. '&lt;/style&gt;';

}

// Código Fonte de Exemplo: http://wpsnippy.com/add-custom-login-logo-in-your-wordpress-blog/

?&gt;</pre>

<p>Coloque um arquivo de imagem <code>login-logo.png</code> dentro do diretório <code>/images/</code> do seu tema e você estará pronto!</p>

<h2>Adicionando Colunas Extras à Listagem de Usuários</h2>

<p>Lembra-se da lista de usuários na página "Todos Usuários" do painel administrativo? A ação <code>manage_users_custom_column</code> permite-nos adicionar colunas extras a essa lista com a ajuda de um filtro.</p>

<h3>Mostrando a Data de Registro em uma Coluna</h3>

<p>Suponha que você quer ver em lote as datas de registros dos membros. Você pode verificar os registros da sua base de dados, sempre que precisar dessa informação, ou você pode usar o trecho de código abaixo para adicionar uma coluna extra à listagem de usuários:</p>

<pre class="brush: php">&lt;?php

add_action( 'manage_users_custom_column', 'manage_users_custom_column_example', 10, 3 );
add_filter( 'manage_users_columns', 'manage_users_columns_example' );

// Cria uma nova coluna chamada "Data de Registro"
function manage_users_columns_example( $columns ) {

	$columns['user_registered'] = __( 'Data de Registro', 'theme-name' );
	return $columns;

}

// preenche as células da coluna com as datas de registros
function manage_users_custom_column_example( $value, $column_name, $user_id ) {

	if ( 'user_registered' == $column_name ) {

		$userdata = get_userdata( $user_id );
		return $userdata-&gt;user_registered;

	}

}

// Código Fonte de Exemplo (da ideia): http://tommcfarlin.com/add-custom-user-meta-during-registration/

?&gt;</pre>

<p>Agora, você sabe um pouco mais sobre seus usuários.</p>

<h2>Manipulando Ativações de <em>Plugins</em></h2>

<p>O que você precisa fazer quando quer saber se um <em>plugin</em> está ativo no WordPress? Bem, você usa o gancho <code>activated_plugin</code>: Essa pequena e útil ação é executada na ativação de <em>plugins</em>.</p>

<h3>Enviando E-mail para o Administrador Sempre Que um <em>Plugin</em> é Ativado</h3>

<p>Suponha que você tenha vários sites de clientes (que foram instalados usando seu endereço de e-mail) e você precisa informar quando clientes instalam e ativam novos <em>plugins</em> em seus sites. </p>

<p>Apenas use essa função e atrele-a à ação <code>activated_plugins</code> e pronto:</p>

<pre class="brush: php">&lt;?php

add_action( 'activated_plugin', 'activated_plugin_example', 10, 2);
function activated_plugin_example( $plugin, $network_activation ) {

$to			= get_option( 'admin_email' );
	$subject	= 'Um plugin foi ativado';
	$body		= "Ei,\n\nO plugin abaixo foi ativado:\n\n$plugin\n\nAté!";

    wp_mail( $to, $subject, $body );
}

?&gt;</pre>

<h2>Manipulando as Opções de Paleta de Cores</h2>

<p>Desde a versão 3.0 do WordPress, nós temos "paletas de cores" para o painel administrativo e não somos permitidos editar, adicionar ou removê-las. A ação <code>admin_color_scheme_picker</code> resolve esse problema!</p>

<h3>Removendo a Opção de Alterar as Paletas de Cores</h3>

<p>Este exemplo não precisa de muita introdução: Se precisar remover a opção de alterar a paleta de cores (talvez você tenha uma paleta de cores especial e não quer que os usuários voltem para a padrão), use o trecho abaixo e remova a opção:</p>

<pre class="brush: php">&lt;?php

if( is_admin() ) {
	remove_action( 'admin_color_scheme_picker', 'admin_color_scheme_picker' );
}

// Código Fonte de Exemplo: http://wpsnipp.com/index.php/functions-php/remove-admin-color-scheme-picker-from-profile/

?&gt;</pre>

<p>Veja só, acabamos de remover uma função de um gancho de ação de mesmo nome! Eu sei, eu sei... é bem estranho.</p>

<h2>Manipulando o Processo de Saída do Sistema</h2>

<p>Usuário acessam e saem do painel administrativo, e quando eles saem, a ação <code>wp_logout</code> é chamada.</p>

<h3>Redirecionando o Usuário para a Página Inicial Após Saída</h3>

<p>Sair do painel administrativo de um site em WordPress é um pouco estranho: Você é redirecionado para a página de acesso, como se o WordPress quisesse que você acessasse o painel novamente. Eis como ajustar essa situação e redirecionar seus usuários para a página inicial:</p>

<pre class="brush: php">&lt;?php

add_action( 'wp_logout', 'wp_logout_example' );

function wp_logout_example() {
	wp_redirect( home_url() );
	exit();
}

// Código Fonte de Exemplo: http://wpsnippy.com/auto-redirect-users-after-logout/

?&gt;</pre>

<p>Agora, toda vez que um usuário sair, ele será direcionado para a página inicial.</p>

<h2>Fim da Parte Cinco</h2>

<p>Enfim, terminamos o último conjunto das 50 ações neste artigo. Espero que tenha gostado e aprendido novas coisas. Brinque um pouco com o que você aprendeu. No próximo artigo, daremos uma revisada naquilo que vimos e encerraremos a série. </p>

<p>Gostaria de saber o que vocês têm achado desta série. Tem gostado das ações selecionadas? Deixe seus comentários, logo abaixo. E, caso tenha curtido o artigo, não esqueça de compartilhá-lo!</p>