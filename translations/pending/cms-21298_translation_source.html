<h1>50 Filters of WordPress: 21-30</h1>

<p>In the previous parts of this series, we went through 30 WordPress filters. In this tutorial, we're going to see another batch of them and do examples with each.</p>

<p>Let's begin!</p>

<h2>Filtering the Search Query</h2>

<p>Searching is one of the most important features of WordPress (and it has stayed kind of primitive, for some reason). With the <code>posts_search</code> filter, you can monkey with the search SQL.</p>

<h3>Example: Including Password Protected Posts in Search Results</h3>

<p>Let's say you use posts for your clients' information and you set passwords for each post and send the password for your client. </p>

<p>To let the clients search amongst the posts and find their own page, you can use the code snippet below to enable visitors find password-protected posts within the search results:</p>

<pre class="brush: php">&lt;?php

add_filter( 'posts_search', 'posts_search_example' );

function posts_search_example( $search ) {
	global $wpdb;
	if( !is_user_logged_in() ) {
		$pattern = " AND ({$wpdb-&gt;prefix}posts.post_password = '')";
		$search = str_replace( $pattern, '', $search );
	}
	return $search;
}

// Example source: http://wpsnipp.com/index.php/functions-php/include-password-protected-posts-in-search-results/

?&gt;</pre>

<p>If the users of your blog are registered, you don't have to use the code above: They can search through password-protected posts as long as they're logged in – but of course, they still can't see the content unless they enter the password.</p>

<h2>Setting Compression Quality for Uploaded Images</h2>

<p>By default, WordPress tries to compress your images while resizing for the defined image sizes. With the <code>wp_editor_set_quality</code> filter, you can change or disable the compression rate.</p>

<h3>Example: Prevent WordPress from Compressing &amp; Distorting Your Images</h3>

<p>Image compression in PHP results in subtle distortions which can only be seen by keen eyes for details. If your website have an sharp-eyed audience (Designers, maybe?) and don't want WordPress to use this compression algorithm, you can use the code below to disable compression and avoid distortion:</p>

<pre class="brush: php">&lt;?php

add_filter( 'wp_editor_set_quality', 'wp_editor_set_quality_example' );

function wp_editor_set_quality_example( $quality ) {
	return 100;
}

?&gt;</pre>

<h2>Filtering the Text Widget</h2>

<p>Default widgets in WordPress has their own filters. The <code>widget_text</code> filter is the filter of, you guessed it, the Text widget.</p>

<h3>Example: Enable Shortcodes for the Text Widget</h3>

<p>It's kind of annoying that WordPress doesn't let us use shortcodes in the text widget by default. Thanks for its filter, though, we can enable shortcodes within the widget:</p>

<pre class="brush: php">&lt;?php

add_filter( 'widget_text', 'do_shortcode' );

?&gt;</pre>

<p>...wait, no function to hook? Actually, there is: It's a core function named <code>do_shortcode()</code> which you may have heard of. Since there's already a function to hook to the filter, we don't have to write another one.</p>

<h2>Filtering the Feed Content</h2>

<p>As you can filter the post content with <code>the_content</code>, you can tamper with the feed items, too, with the <code>the_content_feed</code> filter.</p>

<h3>Example: Inserting Post Thumbnails to Feed Items</h3>

<p>This example is one of my favorites among all the examples in this series: Adding the much-needed post thumbnail to your feed items!</p>

<pre class="brush: php">&lt;?php

add_filter( 'the_content_feed', 'the_content_feed_example' );

function the_content_feed_example( $content ) {
	$featured_image = '';
	$featured_image = get_the_post_thumbnail( get_the_ID(), 'thumbnail', array( 'style' =&gt; 'float:left;margin-right:.75em;' ) );
	$content = get_the_excerpt() . ' &lt;a href="'. get_permalink() .'"&gt;' . __( 'Read More' ) . '&lt;/a&gt;';
	if( '' != $featured_image )
		$content = '&lt;div&gt;' . $featured_image . $content . '&lt;br style="clear:both;" /&gt;&lt;/div&gt;';
	return $content;
}

?&gt;</pre>

<p>If you want the thumbnails to be displayed on the right of the excerpt, simply change <code>'float:left;margin-right:.75em;'</code> with <code>'float:right;margin-left:.75em;'</code>.</p>

<h2>Changing Buttons from the Visual Editor</h2>

<p>WordPress comes with TinyMCE, an advanced WYSIWYG editor that we use while we write our posts. With the <code>mce_buttons</code> filter, we can change the first line of buttons in that editor.</p>

<h3>Example: Remove Unwanted Buttons from the Visual Editor</h3>

<p>If you run a multi-author blog and you don't want your authors to use specific buttons in the visual editor, you can remove some of the buttons (or all of them) with the code below:</p>

<pre class="brush: php">&lt;?php

add_filter( 'mce_buttons', 'mce_buttons_example' );

function mce_buttons_example( $buttons ) {
	$remove_array = array( 'strikethrough', 'blockquote', 'hr', 'alignleft', 'aligncenter', 'alignright', 'wp_more', 'wp_adv' );
	// full list (WP version 3.9)
	// 'bold', 'italic', 'strikethrough', 'bullist', 'numlist', 'blockquote', 'hr', 'alignleft', 'aligncenter', 'alignright', 'link', 'unlink', 'wp_more', 'spellchecker', 'fullscreen', 'wp_adv'
	foreach( $remove_array as $remove ) {
		if ( ( $key = array_search( $remove, $buttons ) ) !== false )
			unset( $buttons[ $key ] );
	}
	return $buttons;
}

?&gt;</pre>

<p>Note that it doesn't disable the usage of the things you remove – it just removes the buttons.</p>

<p>As I said, this filter deals with the <strong>first line</strong> of the buttons in the visual editor. For the second line (the "advanced buttons"), there is another filter named <code>mce_buttons_2</code> and there are two additional filters for two emtpy lines: <code>mce_buttons_3</code> and <code>mce_buttons_4</code>.</p>

<h2>Excluding Terms from Lists</h2>

<p>There might be times when you need to "exclude" a term from every single term list in your website. This little filter allows us to do exactly what its name suggests.</p>

<h3>Example: Excluding the Categories Your Plugin Created</h3>

<p>Imagine you built a plugin that needs to create two categories named "Favorited-MyPlugin" and "Hated-MyPlugin". It would look ugly if the tags were listed in the categories lists, so you need to <em>hide</em> them from the lists. Here's how you do it:</p>

<pre class="brush: php">&lt;?php

add_filter( 'list_terms_exclusions', 'list_terms_exclusions_example', 10, 2 );

function list_terms_exclusions_example( $exclusions, $args ) {
	// IDs of terms to be excluded
	$exclude = "42,132";
	$exterms = wp_parse_id_list( $exclude );
	foreach ( $exterms as $exterm ) {
		if ( empty( $exclusions ) )
			$exclusions  = ' AND ( t.term_id &lt;&gt; ' . intval( $exterm ) . ' ';
		else
			$exclusions .= ' AND t.term_id &lt;&gt; ' . intval( $exterm ) . ' ';
	}
	if ( !empty( $exclusions ) )
		$exclusions .= ')';
	return $exclusions;
}

// Example source: http://shailan.com/2598/how-to-exclude-categories-and-tags-from-your-widgets/

?&gt;</pre>

<p>Here's an interesting feature: This filter also hides the terms from your back-end lists. Cool... <em>and creepy</em>.</p>

<h2>Changing the Image Sizes Dropdown</h2>

<p>If you pick an image to use in your posts, you get to choose a size before adding it to the post content. This handy filter allows us to add custom image sizes (created with the <code>add_image_size()</code> function beforehand) to the dropdown menu where we select sizes.</p>

<h3>Example: Letting Writers Choose Custom Image Sizes</h3>

<p>Suppose you already created a custom image with a name of "golden-ratio-thumb" and you need your authors to add images with that size into their posts when necessary. Here's how you add the custom image size to the <code>&lt;select&gt;</code> menu:</p>

<pre class="brush: php">&lt;?php

add_filter( 'image_size_names_choose', 'image_size_names_choose_example' );

function image_size_names_choose_example( $sizes ) {
	return array_merge( $sizes, array(
		'golden-ratio-thumb' =&gt; __( 'Golden Ratio Thumbnail' )
	) );
}

// Example source: http://codex.wordpress.org/Plugin_API/Filter_Reference/image_size_names_choose

?&gt;</pre>

<p>It's almost too easy, right?</p>

<h2>Changing the "More" String on Excerpts</h2>

<p>WordPress cuts off the first 55 words of your posts, removes formatting and calls them "excerpts", summaries of the posts. At the end of the excerpts, there is a <code>[...]</code> string which is kind of annoying for me. Luckily, the <code>excerpt_more</code> filter allows us to change it.</p>

<h3>Example: Adding a Link to the Post After the Excerpt</h3>

<p>Let's say you want to change that text and turn it into a link to the post. Here's how you do it:</p>

<pre class="brush: php">&lt;?php

add_filter( 'excerpt_more', 'excerpt_more_example' );

function excerpt_more_example( $text ) {
	global $post;
	return '... &lt;a class="read-more-link" href="' . get_permalink( $post-&gt;ID ) . '"&gt;Read more&lt;/a&gt;';
}

?&gt;</pre>

<p>So now, that annoying bit of text has been put to good use.</p>

<h2>Managing Columns in the Posts List</h2>

<p>On the Posts page in your admin panel, you can see the list of your posts as a table with additional information like authors, categories, tags of the posts. </p>

<p>The <code>manage_posts_columns</code> allows us to hide them or add new ones (by using actions and action functions).</p>

<h3>Example: Remove the "Author" Column</h3>

<p>If you're the only author in your website, you don't need to see the author of each post; so you might as well remove that column to save space. Here's how you do it:</p>

<pre class="brush: php">&lt;?php

add_filter( 'manage_posts_columns', 'manage_posts_columns_example' );

function manage_posts_columns_example( $columns ) {
	unset( $columns['author'] );
	return $columns;
}

?&gt;</pre>

<p>There you go! By default, there are seven columns which you can hide:</p>

<ul>
  <li><code>cb</code> (the checkboxes)</li>
  <li><code>title</code></li>
  <li><code>author</code></li>
  <li><code>categories</code></li>
  <li><code>tags</code></li>
  <li><code>comments</code></li>
  <li><code>date</code></li>
</ul>

<p>[tip]To make it work in custom post types, you can use the <code>manage_$post_type_posts_columns</code> where <code>$post_type</code> is the ID name of your custom post type.[/tip]</p>

<h2>Editing Users' Contact Methods</h2>

<p>Did you know that you can add (or remove) fields in user profiles? Yep, that's what the <code>user_contactmethods</code> filter is for.</p>

<h3>Example: Adding User Fields for Social Media Accounts</h3>

<p>This is kind of a popular code snippet because WordPress—still—has profile fields like "Jabber" and "AIM" and people want to get rid of them. In this example, we're going to delete some default "contact methods" and add a few <em>new</em> profile fields:</p>

<pre class="brush: php">&lt;?php

add_filter( 'user_contactmethods', 'user_contactmethods_example' );

function user_contactmethods_example( $contactmethods ) {
	unset( $contactmethods['yim'] );
	unset( $contactmethods['aim'] );
	unset( $contactmethods['jabber'] );
	$contactmethods['facebook']		= 'Facebook'; 
	$contactmethods['twitter']		= 'Twitter';
	$contactmethods['gplus']		= 'Google+';
	$contactmethods['linkedin']		= 'LinkedIn';
	$contactmethods['instagram']	= 'Instagram';
	return $contactmethods;
}

?&gt;</pre>

<p>The profile fields look more like 2014 and less like 2002 now, right?</p>

<h2>End of Part Three</h2>

<p>We went through the second batch of 50 filters in this article. I hope you liked and learned new things from it. See you in the next one!</p>

<p>I want to hear your thoughts, too. What do you think about these filters? Post your comments below; and if you liked the article, don't forget to share it!</p>