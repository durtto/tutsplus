<h1>Getting the Hang of Hanging Punctuation</h1>

<p>Hanging Punctuation is a powerful typographic tool for creating optically aligned bodies of text. Unfortunately, it has been largely forgotten on the web … until now. We’ll take a look at the value of hanging punctuation and how you can partially implement it using a little javascript and a CSS rule which has been around for years.</p>

<h2>Hanging Punctuation: A Primer</h2>

<p>When <a href="http://en.wikipedia.org/wiki/Johannes_Gutenberg" target="_self">Gutenberg</a> was creating his Bible in the 1400’s he developed a style of typesetting punctuation marks which has endured to this day, called “hanging punctuation” (also known as optical alignment).</p>

<h3>What is Hanging Punctuation?</h3>

<p>Hanging punctuation is a method of setting punctuation marks <i>outside</i> the margins of a body of text. This creates the appearance of a uniform edge in the text and allows for a better optical flow.</p>

<figure class="post_image">
  <img alt="" src="https://s3.amazonaws.com/cms-assets.tutsplus.com/uploads/users/30/posts/19890/image/hung-not-hung.png"/>
</figure>

<p>Hanging punctuation impacts they way you perceive the layout of text on a page.</p>

<figure class="post_image">
  <img alt="" src="https://s3.amazonaws.com/cms-assets.tutsplus.com/uploads/users/30/posts/19890/image/hanging-punctuation-example.gif"/>
</figure>

<h3>Where Hanging Punctuation Occurs</h3>

<p>Hanging punctuation occurs in the margins outside the alignment of the rest of the text. You can hang punctuation in left-aligned, right-aligned, or justified text.</p>

<figure class="post_image">
  <img alt="" src="https://s3.amazonaws.com/cms-assets.tutsplus.com/uploads/users/30/posts/19890/image/alignment.gif"/>
</figure>

<h3>Why We Hang Punctuation</h3>

<p>The theory behind why hanging punctuation is important goes something like this:</p>

<p>Punctuation marks in text only take up a small amount of cap height. Ordinarily this isn’t a problem, but when the punctuation mark is the first character on the straight edge of a body of text it leaves an abnormal amount of vertical spacing which can disrupt the visual flow of a body of text.</p>

<figure class="post_image">
  <img alt="" src="https://s3.amazonaws.com/cms-assets.tutsplus.com/uploads/users/30/posts/19890/image/cap-height.png"/>
</figure>

<p>Hanging punctuation fixes this disruption. Naturally, some marks will fall on the edge of the text. Rather than leaving them there and disrupting the optical flow of the body of text, the typographer alleviates the disruption by hanging the punctuation marks in the margins.</p>

<h3>Which Punctuation Marks Can Be Optically Aligned?</h3>

<p>As hanging punctuation alleviates the disruption from small cap height marks, it follows that you should generally hang small cap height marks such as quotation marks (” “ ’ ‘) and hyphens (– —). You should avoid hanging full cap height punctuation marks such as the exclamation point (!) and question mark (?).</p>

<h2>Hanging Punctuation: In Print and on the Web</h2>

<p>Support for hanging punctuation in desktop publishing programs, like Adobe InDesign, has come a long way. InDesign provides great tools for hanging punctuation in bodies of text. Of course, that’s great for people who design using desktop publishing software, but what about web designers?</p>

<p>The problem with achieving hanging punctuation on the web is that everything is built with boxes. Style rules in CSS use the “box model” which wraps all HTML elements in containing boxes. These boxes consist of margins, borders, padding and content.</p>

<figure class="post_image">
  <img alt="" src="https://s3.amazonaws.com/cms-assets.tutsplus.com/uploads/users/30/posts/19890/image/box-model.png"/>
</figure>

<p>By default, all text characters on the web reside within a box. Hanging punctuation, by contrast, requires that characters be <i>outside</i> the box. This has been a tricky problem to solve with software, so implementing the typographic trick of hanging punctuation has largely been ignored on the web, by designers and browser makers alike. As <a href="http://www.markboulton.co.uk/journal/five-simple-steps-to-better-typography-part-2">Mark Boulton states</a>, it’s a great shame that such an important aspect of typesetting has just been swept under the rug.</p>

<h2>Hanging Punctuation and the Spec</h2>

<p>It may surprise you, but hanging punctuation is actually in the <a href="http://www.w3.org/TR/css3-text/#hanging-punctuation-property">CSS3 text module</a>. The hanging punctuation property, however, is marked optional which contributes to the fact that no one has implemented it yet. In fact, if not implemented, the property is “at risk and may be cut from the spec during its CR period if there are no (correct) implementations”.</p>

<p>Since no browsers have implemented this property yet, we won’t go into implementation details for the <code>hanging-punctuation</code> property. However, if you are curious, you can read <a href="http://www.w3.org/TR/css3-text/#hanging-punctuation-property">the spec itself</a> or <a href="http://css-tricks.com/almanac/properties/h/hanging-punctuation/">Chris Coyer’s overview on CSS Tricks</a> for more information.</p>

<h3>Punctuation Marks for Hanging</h3>

<p>There is one piece of valuable information we can glean from the spec. It details which punctuation marks should be hung:</p>

<table>
  <tbody>
    <tr>
      <td>U+002C</td>
      <td>,</td>
      <td>COMMA</td>
    </tr>
    <tr>
      <td>U+002E</td>
      <td>.</td>
      <td>FULL STOP</td>
    </tr>
    <tr>
      <td>U+060C</td>
      <td>،</td>
      <td>ARABIC COMMA</td>
    </tr>
    <tr>
      <td>U+06D4</td>
      <td>۔</td>
      <td>ARABIC FULL STOP</td>
    </tr>
    <tr>
      <td>U+3001</td>
      <td>、</td>
      <td>IDEOGRAPHIC COMMA</td>
    </tr>
    <tr>
      <td>U+3002</td>
      <td>。</td>
      <td>IDEOGRAPHIC FULL STOP</td>
    </tr>
    <tr>
      <td>U+FF0C</td>
      <td>，</td>
      <td>FULLWIDTH COMMA</td>
    </tr>
    <tr>
      <td>U+FF0E</td>
      <td>．</td>
      <td>FULLWIDTH FULL STOP</td>
    </tr>
    <tr>
      <td>U+FE50</td>
      <td>﹐</td>
      <td>SMALL COMMA</td>
    </tr>
    <tr>
      <td>U+FE51</td>
      <td>﹑</td>
      <td>SMALL IDEOGRAPHIC COMMA</td>
    </tr>
    <tr>
      <td>U+FE52</td>
      <td>﹒</td>
      <td>SMALL FULL STOP</td>
    </tr>
    <tr>
      <td>U+FF61</td>
      <td>｡</td>
      <td>HALFWIDTH IDEOGRAPHIC FULL STOP</td>
    </tr>
    <tr>
      <td>U+FF64</td>
      <td>､</td>
      <td>HALFWIDTH IDEOGRAPHIC COMMA</td>
    </tr>
  </tbody>
</table>

<p>The spec states that other characters may be hung if appropriate, which is good as this list is  not comprehensive. For example, the spec doesn’t mention dashes, which traditional typography denotes as punctuation worthy of hanging.</p>

<p>As recommended at <a href="http://recoveringphysicist.com/21/">The Recovering Physicist</a>, traditional Western languages will likely only hang the following punctuation marks:</p>

<table>
  <thead>
    <tr>
      <th>Code Point</th>
      <th>Character</th>
      <th>Name</th>
      <th>HTML Entity</th>
      <th>Unicode Category</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>U+00AB</td>
      <td>«</td>
      <td>LEFT-POINTING DOUBLE ANGLE QUOTATION MARK</td>
      <td>&amp;laquo;</td>
      <td>Pi</td>
    </tr>
    <tr>
      <td>U+00BB</td>
      <td>»</td>
      <td>RIGHT-POINTING DOUBLE ANGLE QUOTATION MARK</td>
      <td>&amp;raquo;</td>
      <td>Pf</td>
    </tr>
    <tr>
      <td>U+2018</td>
      <td>’</td>
      <td>RIGHT SINGLE QUOTATION MARK</td>
      <td>&amp;rsquo;</td>
      <td>Pi</td>
    </tr>
    <tr>
      <td>U+2018</td>
      <td>‘</td>
      <td>LEFT SINGLE QUOTATION MARK</td>
      <td>&amp;lsquo;</td>
      <td>Pf</td>
    </tr>
    <tr>
      <td>U+201C</td>
      <td>“</td>
      <td>LEFT DOUBLE QUOTATION MARK</td>
      <td>&amp;ldquo;</td>
      <td>Pi</td>
    </tr>
    <tr>
      <td>U+201D</td>
      <td>”</td>
      <td>RIGHT DOUBLE QUOTATION MARK</td>
      <td>&amp;rdquo;</td>
      <td>Pf</td>
    </tr>
    <tr>
      <td>U+2039</td>
      <td>‹</td>
      <td>SINGLE LEFT-POINTING ANGLE QUOTATION MARK</td>
      <td>&amp;lsaquo;</td>
      <td>Pi</td>
    </tr>
    <tr>
      <td>U+203A</td>
      <td>›</td>
      <td>SINGLE RIGHT-POINTING ANGLE QUOTATION MARK</td>
      <td>&amp;rsaquo;</td>
      <td>Pf</td>
    </tr>
    <tr>
      <td>U+2010</td>
      <td>‐</td>
      <td>HYPHEN</td>
      <td>&amp;#x2010;</td>
      <td>PD</td>
    </tr>
    <tr>
      <td>U+2013</td>
      <td>–</td>
      <td>EN DASH</td>
      <td>&amp;ndash;</td>
      <td>PD</td>
    </tr>
    <tr>
      <td>U+2014</td>
      <td>—</td>
      <td>EM DASH</td>
      <td>&amp;mdash;</td>
      <td>PD</td>
    </tr>
  </tbody>
  <tbody>
</tbody>
</table>

<p>For Western languages, punctuation marks like dashes, periods, commas, colons, semicolons, etc, are generally hung at the right margin as they don’t normally begin paragraphs or appear on the left margin.</p>

<h2>Bringing Hanging Punctuation to the Web Now</h2>

<p>Ideally you’d hang all qualifying punctuation in a paragraph of text, but this is the web and incomplete CSS support makes it hard to fully implement hanging punctuation in left- and right-aligned texts as well as justified texts.</p>

<p>Hanging punctuation in a single margin, for example the left margin for left-aligned text, can be easier to control. Block level elements like <code>&lt;blockquote&gt;</code>, <code>&lt;p&gt;</code>, <code>&lt;h1&gt;</code> through <code>&lt;h5&gt;</code> tags that begin with qualifying punctuation marks can use a negative <code>text-indent</code> value to hang the punctuation.</p>

<figure class="post_image">
  <img alt="" src="https://s3.amazonaws.com/cms-assets.tutsplus.com/uploads/users/30/posts/19890/image/negative-indent.png"/>
</figure>

<p>It’s worth noting that hanging punctuation using a negative <code>text-indent</code> will only allow you to hang the punctuation at the very beginning of a paragraph. Because text re-flows on the web depending on screen size, you never know where punctuation marks will fall. The beginning punctuation mark is the only one whose position you can be sure of.</p>

<figure class="post_image">
  <img alt="" src="https://s3.amazonaws.com/cms-assets.tutsplus.com/uploads/users/30/posts/19890/image/hung-beginning.png"/>
</figure>

<p>In spite of these short comings, exploring the possibilities of hanging beginning punctuation can still be valuable. It’s a typographic choice you can make as the designer.</p>

<p>In this tutorial we will look at how to hang beginning punctuation in traditional left-aligned Western English texts. Remember that code is malleable. You can take the examples in this tutorial and tweak them to fit whatever need you have. Hopefully, in the future, browsers will better solve the issue of hanging punctuation marks.</p>

<h2>Step 1: A Quick Overview</h2>

<p>The idea behind implementing hanging punctuation for left-aligned text is rather simple. Use JavaScript to find all eligible DOM elements within the context of an article layout that begin with hangable punctuation. When found, apply an HTML class to the element that has a negative value for the <code>text-indent</code> rule.</p>

<h2>Step 2: Examining The Markup</h2>

<p>Let’s look at a basic example of markup used to layout a simple blog post. The text of the article would be laid out in headings, subheadings, lists, and quotes all as sibling elements, like this:</p>

<pre class="brush: html">&lt;article class="post"&gt;
&lt;h1&gt;Article Title&lt;/h1&gt;
    &lt;p&gt;Some text here ...&lt;/p&gt;
    &lt;p&gt;"A paragraph" that begins with hangable punctuation ...&lt;/p&gt;
    &lt;h2&gt;A Subheading for the Article&lt;/h2&gt;
    &lt;p&gt;Text here ...&lt;/p&gt;
    &lt;blockquote&gt;
        &lt;p&gt;Quoted text ...&lt;/p&gt;
        &lt;p&gt;In multiple paragraphs ...&lt;/p&gt;
    &lt;/blockquote&gt;
    &lt;p&gt;More text ...&lt;/p&gt;
    &lt;h2&gt;"A Subheading" Beginning With Punctuation&lt;/h2&gt;
    &lt;p&gt;Some more text ...&lt;/p&gt;
    &lt;ul&gt;
        &lt;li&gt;List text ...&lt;/li&gt;
        &lt;li&gt;A second list item&lt;/li&gt;
    &lt;/ul&gt;
    &lt;p&gt;More text ...&lt;/p&gt;
    &lt;p&gt;Last paragraph.&lt;/p&gt;
&lt;/article&gt;
</pre>

<p>Your own markup pattern may differ from this, in which case you can later tweak the javascript to find DOM elements according to how your markup is laid out. For this tutorial, we’ll use this simple markup pattern.</p>

<p>In order to hang beginning punctuation for elements within a block of text we must first delineate which punctuation marks can be hung, which we analyzed earlier in the tutorial. It’s important to remember that different languages use <a href="http://webdesign.tutsplus.com/articles/start-using-quotation-marks-the-correct-way--webdesign-16905" target="_self">quotation (and punctuation) marks</a> in widely varying manners. For example, take a look at how English and Welsh use primary and secondary quotation marks:</p>

<ul>
  <li><strong>English</strong>: I told Johnny, “Mark Twain once said, ‘If you tell the truth, you don’t have to remember anything.’”</li>
  <li><strong>Welsh</strong>: I told Johnny, ‘Mark Twain once said, “If you tell the truth, you don’t have to remember anything.”’</li>
</ul>

<p>Notice how they are complete opposites? Those differences are only the beginning. Take a look at this example of primary and secondary quotation mark usage in just a handful of languages (you can see a larger compilation at <a href="http://en.wikipedia.org/wiki/International_variation_in_quotation_marks&#10;">Wikipedia</a>):</p>

<table>
  <thead>
    <tr>
      <th>Language</th>
      <th>Primary</th>
      <th>Secondary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>English</td>
      <td>“…”</td>
      <td>‘…’</td>
    </tr>
    <tr>
      <td>Welsh</td>
      <td>‘…’</td>
      <td>“…”</td>
    </tr>
    <tr>
      <td>Croatian</td>
      <td>„…”</td>
      <td>‚…’</td>
    </tr>
    <tr>
      <td>German</td>
      <td>„…“</td>
      <td>‚…‘</td>
    </tr>
    <tr>
      <td>Greek</td>
      <td>«…»</td>
      <td>“…”</td>
    </tr>
    <tr>
      <td>French</td>
      <td>«…»</td>
      <td>‹…›</td>
    </tr>
  </tbody>
</table>

<p>It’s good to be mindful of these differences, so if you ever have to work with languages other than Western English you’ll have a firmer grasp on which punctuation marks you should be hanging.</p>

<h2>Step 3: Setting Up the CSS</h2>

<p>Now we have some basic markup for our text layout. We will use JavaScript to parse each of those DOM objects and find the ones that begin with hangable punctuation. For the ones that begin with qualifying punctuation, we will apply a HTML class with a negative value for <code>text-indent</code> rule which will hang the punctuation in the left margin.</p>

<p>The tricky part here comes in defining the value of your <code>text-indent</code> rule. Different fonts will require different values, so this will take some tweaking and customizing on your part. For example, a smart double quote (“) has a thicker width than a smart single quote (‘). Hence, if you're hanging punctuation, the DOM element that begins with a smart double quote will require a larger value for the <code>text-indent</code> rule than a DOM element beginning with a smart single quote.</p>

<figure class="post_image">
  <img alt="" src="https://s3.amazonaws.com/cms-assets.tutsplus.com/uploads/users/30/posts/19890/image/text-indent-compare.png"/>
</figure>

<h3>A Note on Fonts</h3>

<p>Not only will the <code>text-indent</code> value be different depending on the width of the punctuation mark you’re hanging, but it will also depend on the typeface you’re using. Of course, this is the web, and you can’t always ensure a user will be using a certain typeface. However, web safe fonts have a good ubiquity while non web safe fonts have some pretty <a href="http://www.fontspring.com/blog/the-new-bulletproof-font-face-syntax">bullet-proof methods</a> of serving specific fonts to clients. Either way, you can come pretty close to ensuring everyone is seeing the same font.</p>

<figure class="post_image">
  <img alt="" src="https://s3.amazonaws.com/cms-assets.tutsplus.com/uploads/users/30/posts/19890/image/punctuation-sizes.png"/>
</figure>

<p>Whatever font or font stack you end up using, it’s good to preview and tweak your <code>text-indent</code> values on a per-font basis (and preferably at various sizes). This ensures that your hanging punctuation marks will align correctly.</p>

<h3>The Hanging Punctuation Classes</h3>

<p>Assuming that all the elements of our post are using the same typeface, we can setup three classes defining three widths: small, medium, and large. Depending on which type of punctuation it begins with, our JavaScript will apply one of these three classes to the DOM element thus giving us hanging punctuation!</p>

<pre class="brush: css">.indent-small {text-indent: -.2325em}
.indent-medium {text-indent: -.4125em} 
.indent-large {text-indent: -.6125em} 
</pre>

<p>Notice we are using <code><a href="http://webdesign.tutsplus.com/articles/taking-the-erm-out-of-ems--webdesign-12321" target="_self">em</a></code> measurements. This ensures the <code>text-indent</code> will always be relative to the <code>font-size</code> of the text in the article. So if the font size is increased, you won’t have to change the <code>text-indent</code> values.</p>

<h3>The Hanging Punctuation Classes: Two Typefaces</h3>

<p>But what if you are using two different typefaces in your layout? In the example we are using, our body text elements (<code>&lt;p&gt; &lt;ul&gt; &lt;blockquote&gt;</code>) use one sans-serif typeface (Helvetica Neue, Arial fallback) while our headers (<code>&lt;h1&gt; &lt;h2&gt; &lt;h3&gt;</code>) use a different sans-serif typeface (Source Sans Pro). The punctuation marks of Source Sans Pro are, by design, wider than those of Helvetica Neue and Arial. Thus, DOM elements set in Source Sans Pro (headers) are going to require slightly larger <code>text-indent</code> values than DOM elements set in Helvetica Neue (lists, paragraphs, etc).</p>

<p>This is easy enough to handle by adding additional classes specifically for headers. We will just use JavaScript to detect the element type, then apply the appropriate class.</p>

<pre class="brush: css">.indent-header-small {text-indent: -.325em}
.indent-header-medium {text-indent: -.5125em} 
.indent-header-large {text-indent: -.7125em} 
</pre>

<h2>Step 4: Setting Up a Function in JavaScript</h2>

<p>Now that we have the markup and CSS we need, we are going to use JavaScript to discover any DOM elements that are direct descendants of our article container. We then check to see if those DOM elements begin with punctuation marks that should be hung.</p>

<p>To begin, we will create a function that will contain all our code. This function will take one argument, which is the DOM element containing the text we want to parse for hanging punctuation, for example the container of a blog post.</p>

<pre class="brush: javascript">/*
 * Hanging Punctuation
 * This function takes a DOM element,
 * searches each of its direct descendants,
 * and, if the element begins with hangable punctuation,
 * the appropriate HTML class is applied to the element.
 *
 * Then the parent DOM element get's a class to activate
 * the child classes we applied. 
 */
function hangPunctuation(container) {
// code goes here
}
</pre>

<p><strong>Note</strong>: hanging punctuation is an aspect of progressive enhancement. In this example, we are going to use native JavaScript that is not fully supported in legacy browsers (looking at you IE). If you wanted to get this to work in older browsers, you could do it. Most of the stuff we’ll be doing is selecting elements from the DOM and changing their classes. You could easily incorporate jQuery to do this, or you could use helper functions from <a href="http://youmightnotneedjquery.com">youmightnotneedjquery.com</a></p>

<h2>Step 5: Defining the Punctuation Characters</h2>

<p>We need to create a list of hangable punctuation. Using the characters we defined earlier as a reference, we can create an object in JavaScript defining our punctuation marks (by their Unicode points):</p>

<pre class="brush: javascript">// Punctuation marks that qualify to be hung
var marks = {
'\u201c': 'medium',     // “ - ldquo - left smart double quote
    '\u2018': 'small',      // ‘ - lsquo - left smart single quote
    '\u0022': 'medium',     // " - ldquo - left dumb double quote
    '\u0027': 'small',      // ' - lsquo - left dumb single quote
    '\u00AB': 'large',      // « - laquo - left double angle quote
    '\u2039': 'medium',     // ‹ - lsaquo - left single angle quote
    '\u201E': 'medium',     // „ - bdquo - left smart double low quote
    '\u201A': 'small',      // ‚ - sbquo - left smart single low quote
};
</pre>

<p>As you can see, we define a list of punctuation marks we want to hang with a corresponding width definition that matches our HTML classes. This object tells us which punctuation marks to hang and how large their negative <code>text-indent</code> value should be. This list is not comprehensive. The beauty is that we will loop over the entire list, so you can add additional punctuation marks to this list as needed.</p>

<h2>Step 6: Looping Over Each Child Element</h2>

<p>Now we are going to loop over all direct descendants of our containing element (which was passed into the function). To do so, we will first setup a <code>for</code> loop:</p>

<pre class="brush: javascript">// Loop over all direct descendants of the container
// If it's a blockquote, loop over its direct descendants
for(i=0; i&lt;container.children.length; i++) {
// code goes here
}
</pre>

<p>Next (inside the <code>for</code> loop) we will create a variable called <code>el</code> which represents each direct descendant element of the container we are looping over (get an element’s descendants using the <code>.children</code> property):</p>

<pre class="brush: javascript">var el = container.children[i];</pre>

<p>Now we will pass our <code>el</code> variable to another function (<code>hangIfEligible()</code>), which will check to see if it begins with a punctuation mark that can be hung. If it does, this other function will apply the appropriate HTML class to the element.</p>

<pre class="brush: javascript">if (el.tagName === 'BLOCKQUOTE') {
for (var k = 0; k &lt; el.children.length; k++) {
        hangIfEligible(el.children[k]);
    };
}
else {
    hangIfEligible(el);
}
</pre>

<p>Notice what we did with the <code>blockquote</code> tag? Because <code>blockquote</code> elements may have descendant elements beginning with hanging punctuation (like the <code>&lt;p&gt;</code> tag), we need to loop over each of its children as well. So if the current element we’re looping over is a <code>blockquote</code> tag, we loop over each of its children and pass them to our <code>hangIfEligible()</code> function. If it’s not a <code>blockquote</code> element, we just pass the current element itself to the <code>hangIfEligible()</code> function.</p>

<p>If we didn’t specifically loop over the children of the <code>blockquote</code> element, we would miss its children and a chance to hang punctuation.</p>

<figure class="post_image">
  <img alt="" src="https://s3.amazonaws.com/cms-assets.tutsplus.com/uploads/users/30/posts/19890/image/blockquote.png"/>
</figure>

<p>Our <code>for</code> loop should now looking something like this:</p>

<pre class="brush: javascript">// Loop over all direct descendants of the container
// If it's a blockquote, loop over its direct descendants
for(i=0; i&lt;container.children.length; i++) {

var el = container.children[i];

    if (el.tagName === 'BLOCKQUOTE') {
        for (var k = 0; k &lt; el.children.length; k++) {
            hangIfEligible(el.children[k]);
        };
    }
    else {
        hangIfEligible(el);
    }
}
</pre>

<h2>Step 7: Hanging the Punctuation</h2>

<p>We’ve passed the current child element to our <code>hangIfEligible()</code> function. So now let’s define what that function does:</p>

<pre class="brush: javascript">// Check to see if the passed-in element 
// begins with one of the qualifying punctuation types
// If it does, apply the appropriate class depending on the tag type
function hangIfEligible(el) {
// code goes here
}   
</pre>

<p>As you can see, we have a function named <code>hangIfEligible()</code> which takes one parameter: the DOM element we’re checking for beginning punctuation.</p>

<h3>Getting the Element’s Text</h3>

<p>Now let’s create the variables we’ll need. First we need to get the text inside the DOM element. To do so, we'll use the <code>innerText</code> JavaScript property. Because this doesn’t work in Firefox, we’ll also use the <code>textContent</code> property which does.</p>

<pre class="brush: javascript">var text = el.innerText || el.textContent;
</pre>

<h3>Setting Up the HTML Class Name</h3>

<p>Because our example uses two different fonts (one for headings, one for copy) we’ll need two different classes for the two different element types.</p>

<p>If you remember, our HTML classes which control the negative <code>text-indent</code> follow the naming pattern <code>indent-</code> and then the width of the punctuation mark (small, medium, or large). If the element is a header, we add <code>header-</code> between them. So the class for small width punctuation marks is <code>indent-small</code> for normal copy and <code>indent-header-small</code> for headings.</p>

<p>In our JavaScript, we’ll create a variable for our HTML class and append <code class="inline">header-</code> later on if the current tag is a heading element.</p>

<pre class="brush: javascript">var htmlClass = 'indent-';
</pre>

<h3>Checking the Element for Beginning Punctuation</h3>

<p>Now let’s check and see if the text of our current DOM element begins with one of the punctuation marks we defined earlier. To do so, we’ll loop over each of the entries in our <code>marks</code> variable where we defined the punctuation marks we want to hang. Then we’ll use JavaScript’s <code>indexOf</code> property to check and see if the first character the element’s text matches one of our punctuation marks.</p>

<pre class="brush: javascript">for(var mark in marks) {
if ( text.indexOf(mark) === 0 ){
        // If it matches, code here
    }
}
</pre>

<p>A refresh on <code>indexOf</code>: JavaScript’s <code>indexOf</code> looks at a string where each character is an element in an array. For example, <code>var text = 'A String'</code> would look like this <code>['A', ' ', 'S', 't', 'r', 'i', 'n', 'g']</code>. The <code>indexOf</code> property takes a character and searches the entire array looking for that character. If it finds it, it returns the character’s position in the array. So, in our case, we search for a certain punctuation mark. If it’s found in the very first position of the array (index 0) then our text begins with hangable punctuation.</p>

<h3>Adding a Class</h3>

<p>Now all we have to do is add a class to the element if the first character of its text matches one of our punctuation marks.</p>

<p>In our example, if the element begins with a qualifying punctuation mark, we then need to check if the current element is a header (as our headers need modified HTML classes). So, in the part where we had <code>// if it matches, code here</code> we will put this:</p>

<pre>if (el.tagName === 'H1' || el.tagName === 'H2' || el.tagName === 'H3' || el.tagName === 'H4' || el.tagName === 'H5' )
htmlClass += 'header-';
el.classList.add(htmlClass + marks[mark]);
</pre>

<p>See what we did? If the current element was a heading of some kind, we appended <code>header-</code> to the HTML class name. The HTML class that gets added to our DOM element is constructed like this:</p>

<ul>
  <li><code>indent-</code> by default</li>
  <li><code>header-</code> appended if the current element is a header</li>
  <li><code>small</code>, <code>medium</code>, or <code>large</code> added depending on the current punctuation mark’s defined width</li>
</ul>

<h3>All the Code Together</h3>

<p>All of that code together would look like this:</p>

<pre class="brush: javascript">// Check to see if the passed-in element 
// begins with one of the qualifying punctuation types
// If it does, apply the appropriate class depending on the tag type
function hangIfEligible(el) {
var text = el.innerText || el.textContent;
    var htmlClass = 'indent-';

    for(var mark in marks) {
        if ( text.indexOf(mark) === 0 ){
            if (el.tagName === 'H1' || el.tagName === 'H2' || el.tagName === 'H3' || el.tagName === 'H4' || el.tagName === 'H5' )
                htmlClass += 'header-';
            el.classList.add(htmlClass + marks[mark]);
        }
    }
}
</pre>

<h2>Step 8: Run the Function on Page Load</h2>

<p>Now all you have to do is run the function when the page loads. You can do this with a few lines of code:</p>

<pre class="brush: javascript">window.onload = function() {
var container = document.querySelector('.post')
    hangPunctuation( container );
    container.classList.add('hang-punctuation');
}
</pre>

<p>See what we did here? Call the <code>hangPunctuation</code> function and pass in the containing DOM element of the body of text within which you want to hang punctuation.</p>

<p>Notice that we add a class to the container element. You can use this class to hang <code>&lt;ul&gt;</code> lists if you want. Simply add some CSS like so: <code>.hang-punctuation ul {margin:0; padding:0: list-style-position: outside;}</code></p>

<h2>The Final Code</h2>

<p>That‘s it! We are all finished. Here’s the final code:</p>

<pre class="brush: javascript">/*
 * Hanging Punctuation
 * This function takes a DOM element,
 * searches each of its direct descendants,
 * and, if the element begins with hangable punctuation,
 * the appropriate HTML class is applied to the element.
 *
 * Then the parent DOM element get's a class to activate
 * the child classes we applied. 
 */
function hangPunctuation(container) {

// Punctuation marks that qualify to be hung
    var marks = {
        '\u201c': 'medium',     // “ - ldquo - left smart double quote
        '\u2018': 'small',      // ‘ - lsquo - left smart single quote
        '\u0022': 'medium',     // " - ldquo - left dumb double quote
        '\u0027': 'small',      // ' - lsquo - left dumb single quote
        '\u00AB': 'large',      // « - laquo - left double angle quote
        '\u2039': 'medium',     // ‹ - lsaquo - left single angle quote
        '\u201E': 'medium',     // „ - bdquo - left smart double low quote
        '\u201A': 'small',      // ‚ - sbquo - left smart single low quote
    };
        
    // Loop over all direct descendants of the container
    // If it's a blockquote, loop over its direct descendants
    for(i=0; i&lt;container.children.length; i++) {

        var el = container.children[i];

        if (el.tagName === 'BLOCKQUOTE') {
            for (var k = 0; k &lt; el.children.length; k++) {
                hangIfEligible(el.children[k]);
            };
        }
        else {
            hangIfEligible(el);
        }
    }

    // Check to see if the passed-in element 
    // begins with one of the qualifying punctuation types
    // If it does, apply the appropriate class depending on the tag type
    function hangIfEligible(el) {
        var text = el.innerText || el.textContent;
        var htmlClass = 'indent-';

        for(var mark in marks) {
            if ( text.indexOf(mark) === 0 ){
                if (el.tagName === 'H1' || el.tagName === 'H2' || el.tagName === 'H3' || el.tagName === 'H4' || el.tagName === 'H5' )
                    htmlClass += 'header-';
                el.classList.add(htmlClass + marks[mark]);
            }
        }
    }
}

window.onload = function() {
    var container = document.querySelector('.post')
    hangPunctuation( container );
    container.classList.add('hang-punctuation');
}    
</pre>

<p>It’s good to remember that this solution is in no ways comprehensive. It will most likely require tweaking for each project it’s used on, because each project differs in typeface choices, markup structure, etc. However, if you are laying out longform text, this solution could help add a little bit of typographic refinement to your layout.</p>

<h3>Supplementary Reading:</h3>

<ul>
  <li><a href="http://css-tricks.com/almanac/properties/h/hanging-punctuation/">Hanging Punctuation on CSS Tricks</a></li>
  <li><a href="http://www.markboulton.co.uk/journal/five-simple-steps-to-better-typography-part-2">Mark Boulton on Hanging Punctuation</a></li>
  <li><a href="http://recoveringphysicist.com/21/">Hanging Punctuation in CSS3 by The Recovering Physicist</a></li>
  <li><a href="http://coding.smashingmagazine.com/2011/03/14/technical-web-typography-guidelines-and-techniques/">Harry Roberts covers hanging bullet points and blockquotes on Smashing Magazine</a></li>
</ul>

<h3>An Alternative Approach</h3>

<p>Since publishing this article, others have chimed in with their ideas too. Take a look at the comments and you'll find <a href="https://twitter.com/g16n" target="_self">Gunnar Bittersmann</a>'s inspiring take on the CSS we've discussed. <a href="https://twitter.com/laneolson" target="_self">Lane Olson</a> even combined those thoughts with my JavaScript <a href="http://codepen.io/Lane/pen/kufHo/" target="_self">to make a demo on Codepen</a>.</p>