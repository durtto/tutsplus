<h1>Modern Debugging Experience: Part 1</h1>

<p>In this two part tutorial series, we'll take a look at writing &amp; debugging JavaScript code using modern tooling such as the Chrome DevTools.</p>

<p>In part 1, you'll get a introductory look at the various panels in the DevTools and what workflows they're suitable for. There'll also be a focus on writing and executing JavaScript code through the browser rather than a code editor. </p>

<h2>1. What Are Browser DevTools?</h2>

<p>Developer Tools are features provided by browsers containing a set of utilities to inspect, interact with and debug web pages. Browser DevTools are typically bundled with all modern browsers including Chrome, Firefox, Safari, Opera, and Internet Explorer. This tutorial will focus specifically on the DevTools part of <a href="https://www.google.co.uk/intl/en/chrome/browser/canary.html">Chrome Canary</a>, but all features listed here are likely to be part of Chrome Stable soon.</p>

<h3>What Can DevTools Offer to a JavaScript Developer?</h3>

<p>The open web platform enables you to <strong>Right-Click &gt; Inspect Element</strong> on any web page and discover the internals of it, but JavaScript has always been a bit more out of reach than CSS (Cascading Style Sheets). While DevTools is packed with features related to the styling of the page, there is also a heap of lesser-known functionality which enables you to view, write and debug JavaScript in a variety of ways, whether it’s on your own page or on a third-party site.</p>

<h3>Why Use DevTools for Your JavaScript Workflow?</h3>

<p>If you are a front-end web developer, it’s recommended you at least be aware of the JavaScript utilities DevTools has to offer. High-level features include:</p>

<ul>
  <li>at least two dedicated panels whose use cases cater almost entirely for JavaScript</li>
  <li>a development environment that's quick to set up, with a fast feedback loop</li>
  <li>advance debugging capabilities with breakpoints</li>
</ul>

<h2><span class="sectionnum">2.</span> DevTools Overview</h2>

<p>This section will cover the UI elements of the DevTools, specifically the Sources Panel and the Console Panel, since these are the two panels which will be used for the rest of this tutorial.</p>

<h3>Sources Panel Interface</h3>

<figure class="post_image">
  <img alt="Sources panel interface" src="https://s3.amazonaws.com/cms-assets.tutsplus.com/uploads/users/329/posts/22571/image/md-sources-panel-interface.png"/>
</figure>

<p>Take note of a few layout characteristics:</p>

<ul>
  <li>DevTools is in an undocked state. You may prefer to dock to the left, bottom or right of the main window.</li>
  <li>The Sources Pane in the Sources Panel is selected in the left sidebar.</li>
  <li>The panes in the right sidebar are in an expanded state.</li>
</ul>

<p>The Sources Panel provides you with a code editor, and it supports syntax highlighting for many common file formats such as HTML, CSS, JavaScript, CoffeeScript, LESS, and Sass. The code editor is present within the main pane. Directly above the main pane you can see tabs corresponding to your open files.</p>

<p>In the Sources Pane within the left sidebar there is a file tree typically showing the assets the currently inspected page has loaded. Assets are grouped by domain, and folders can be in an expanded or collapsed state. If you single-click an asset, it will open up in the code editor.</p>

<p>The right sidebar contains controls for JavaScript debugging, and each pane can be in an expanded or collapsed state. Various levels of output are displayed here when JavaScript is paused at a breakpoint.</p>

<h3>Console Panel</h3>

<figure class="post_image">
  <img alt="Console panel" src="https://s3.amazonaws.com/cms-assets.tutsplus.com/uploads/users/329/posts/22571/image/md-console-panel-interface.png"/>
</figure>

<p>The Console Panel enables you to view the output produced by diagnostic logging (such as <code class="inline">console.log</code> statements) but also to write and evaluate JavaScript within the context of the currently inspected page. The Console Panel supports both the <a href="https://developer.chrome.com/devtools/docs/console-api">Console API</a> and the <a href="https://developer.chrome.com/devtools/docs/commandline-api">Command Line API</a>. Here are some functions exposed by each API, along with a description of their output.</p>

<h4><strong>Console API</strong></h4>

<pre class="brush: javascript">//A simple log statement, logging a string, array and an object
console.log('Hi', [1,2,3], this);</pre>

<figure class="post_image">
  <img alt="consolelog" src="https://s3.amazonaws.com/cms-assets.tutsplus.com/uploads/users/329/posts/22571/image/md-console-log-example.png"/>
</figure>

<pre class="brush: javascript">//Same as console.log but formatted in red to signify an error
console.error('An error occurred');</pre>

<p><img alt="consoleerror" src="https://s3.amazonaws.com/cms-assets.tutsplus.com/uploads/users/329/posts/22571/image/md-console-error-example.png"/></p>

<h4><strong>Command Line API</strong></h4>

<pre class="brush: javascript">keys(window); //Get the properties of an object</pre>

<figure class="post_image">
  <img alt="command line API" src="https://s3.amazonaws.com/cms-assets.tutsplus.com/uploads/users/329/posts/22571/image/md-keys-example.png"/>
</figure>

<pre class="brush: javascript">$0; //Retrieve the currently selected element in the Elements Panel</pre>

<p><img alt="Script" src="https://s3.amazonaws.com/cms-assets.tutsplus.com/uploads/users/329/posts/22571/image/md-dollar-zero-example.png"/></p>

<p>The top of the Console Panel contains a few controls as shown below.</p>

<figure class="post_image">
  <img alt="Console panel" src="https://s3.amazonaws.com/cms-assets.tutsplus.com/uploads/users/329/posts/22571/image/md-console-controls.png"/>
</figure>

<ul>
  <li><strong>No symbol</strong> (circle with a backslash) clears the console. This is useful for when more messages than desired are in view and you wish to remove them. You can also use the shortcut <strong>Command-K</strong> to remove them, or execute the function <code>clear()</code>, which is part of the Command Line API.</li>
  <li><strong>Filter</strong> opens a bar with filtering controls including an input box. If you are only interested in finding error messages, select the <strong>Errors</strong> filter option. Alternatively enter a regular expression to use as a filter.</li>
  <li>The <strong>Select menu</strong> (<strong>&lt;top frame&gt;</strong>) provides options for available JavaScript execution contexts to switch to. Use this when you want your JavaScript to be evaluated in the context of an IFrame or Chrome Extension for example.</li>
</ul>

<p>The Console Panel is one of the few panels which you can overlay over other panels in the DevTools (Elements, Network, Sources) to provide an improved workflow. If you find yourself regularly returning to the Console Panel, bring up the Console Drawer by pressing the <strong>Escape</strong> key.</p>

<h2><span class="sectionnum">3.</span> Viewing JavaScript Using the DevTools</h2>

<p>This section will focus on using the DevTools to see JavaScript resources a site is using. Before continuing, it is recommended you disable the browser cache via DevTools. To do this, navigate to <strong>Settings &gt; General</strong> and enable the checkbox titled <strong>Disable cache (while DevTools is open)</strong>. This ensures you are always getting a fresh version of an asset.</p>

<h3>Workflow on Third-Party Sites</h3>

<p>Navigate to <a href="http://html5please.com/">HTML5Please.com</a>, a site explaining the readiness of Web Platform features. Open up the DevTools using <strong>Command-Shift-I</strong> or by selecting <strong>Inspect Element</strong> from the page context menu. Head on over to the <strong>Sources Panel</strong> and take note of the file tree structure shown in the left sidebar. It's not unheard of for websites to store their JavaScript in folders such as "js" or "scripts", so you already know where to look. Open up the <code class="inline">script.js</code> file in the <code class="inline">js</code> folder. Notice a few features of the code editor which can prove useful when you view or edit JavaScript code:</p>

<ul>
  <li>full syntax highlighting</li>
  <li>line and column number of the cursor</li>
  <li>new tab corresponding to the open file</li>
  <li>word occurrences mapped to the current selection</li>
  <li>brace matching</li>
  <li>go-to definition</li>
</ul>

<figure class="post_image">
  <img alt="go-to definition" src="https://s3.amazonaws.com/cms-assets.tutsplus.com/uploads/users/329/posts/22571/image/md-go-to-definition.png"/>
</figure>

<p>Use the go-to definition feature to quickly find or discover JavaScript methods or functions. You can open the go-to definition modal window via the shortcut <strong>Command-Shift-P</strong>. If you know the name of the method or function you are looking for, type it in the go-to definition search box; as you type, results will update in real time. Each result contains the matching method name (if there is one) and the line number where it is defined. Use <strong>Enter</strong> to select a search result, and you then land on the line of code where the function is defined.</p>

<p>Now open <code class="inline">modernizr-2.0.min.js</code> in the <code class="inline">js/libs</code> folder. The fact that this file is minified makes it harder to view. Select <strong>Pretty Print</strong> to have DevTools apply a more intuitive formatting to the file, using line breaks and indentation. The Pretty Print feature works for both CSS and JavaScript.</p>

<h4>Save External JavaScript to the File System</h4>

<p>Each JavaScript file in the file tree has a context menu, so open it up using <strong>right-click</strong>. Notice a few options useful for taking the file offline for later use.</p>

<ul>
  <li><strong>Open link in new tab:</strong> use this if you wish to inspect the network information further in a dedicated tab (via Network Panel).</li>
  <li><strong>Save As:</strong> use this if you want to make an offline copy of the file in your file system.</li>
  <li><strong>Copy Link Address:</strong> use this if you want to share the URL elsewhere.</li>
</ul>

<h4>Find JavaScript in the Network Panel</h4>

<p>The Network Panel, in addition to simply showing you what resources a page has loaded, will also display other information and data.</p>

<ul>
  <li><strong>Initiator:</strong> what caused a script to download</li>
  <li><strong>DOMContentLoaded</strong> (blue) and <strong>Load events</strong> (red): a timeline-based, visual representation of when these events fire</li>
  <li><strong>Size:</strong> the size of the asset, including the Gzip size</li>
</ul>

<p>Using HTML5Please.com as an example website, follow along with the steps below:</p>

<ol>
  <li>Navigate to the <strong>Network Panel</strong> and clear the logs.</li>
  <li>Refresh the page.</li>
  <li>Filter for JavaScript logs by selecting the <strong>Scripts</strong> filter.</li>
</ol>

<p>The first script, <code class="inline">modernizr-2.0.min.js</code>, has the value of <code class="inline">html5please.com/:17</code> for the initiator. This suggests it was an HTML resource which initiated the download of the script (rather than a script loader, for example). Click on the initiator, and you are taken to the line of code in the Sources Panel which references the file:</p>

<pre class="brush: javascript">&lt;script src="js/libs/modernizr-2.0.min.js"&gt;&lt;/script&gt;</pre>

<p>In the event that a script is dynamically inserted (with a script loader for example), the initiator column in the Network Panel can provide a JavaScript call stack relating to the calls which occurred all the way up to the point where the script was dynamically inserted into the DOM.</p>

<figure class="post_image">
  <img alt="Initiator column in Network Panel" src="https://s3.amazonaws.com/cms-assets.tutsplus.com/uploads/users/329/posts/22571/image/md-script-initiator-call-stack.png"/>
</figure>

<p>You can click on each call within a call stack to navigate to the relevant portion of code in the Sources Panel.</p>

<figure class="post_image">
  <img alt="Code in the Sources Panel" src="https://s3.amazonaws.com/cms-assets.tutsplus.com/uploads/users/329/posts/22571/image/md-line-highlight-from-call-stack.png"/>
</figure>

<h2><span class="sectionnum">4.</span> Writing JavaScript using the DevTools</h2>

<p>In the section "Viewing JavaScript using the DevTools", I explained how to view information, metadata, and source code on JavaScript assets. This section will examine the ways you can write JavaScript using the DevTools.</p>

<h3>Console Panel</h3>

<p>Use the Console Panel for writing quick JavaScript one-liners with immediate results. JavaScript is executed with the context of the currently inspected page. Execute some JavaScript in the Console Panel by pressing <strong>Enter</strong> after entering some code.</p>

<p>Refer to the Console API and Command Line API for a list of available methods and functions.</p>

<h4><strong>Tips</strong></h4>

<p>While the Console Panel is relatively simple, there are a few small tips to improve your workflow:</p>

<ul>
  <li>Use <strong>Shift-Enter</strong> for a new line—this enables you to write multi-line code.</li>
  <li>Execute <code>keys(window)</code> to detect global variables on the current page.</li>
  <li>Use the <code>$_</code> helper to retrieve the last result of a previous command.</li>
</ul>

<p>You may find the Console Panel to be a good candidate for quickly experimenting with JavaScript to discover what the output of certain expressions are. However, when you start writing more complex JavaScript, you can easily encounter limitations:</p>

<ul>
  <li>Lack of syntax highlighting can decrease readability.</li>
  <li>Indentation must be done manually with space characters.</li>
  <li>Missing features are typically present in code editors.</li>
</ul>

<p>The Console Panel does not intend to be a code editor replacement or even alternative. Here is a list of some cases where the Console Panel can be useful:</p>

<ul>
  <li>using the autocomplete feature for the sake of property discovery</li>
  <li>finding out the difference between JavaScript's <code>call()</code> and <code>apply()</code> methods by executing them inline and observing the results</li>
</ul>

<h3>Sources Panel</h3>

<p>The main pane of the Sources Panel contains a code editor with basic editing capabilities.</p>

<h4><strong>CodeMirror</strong></h4>

<p>The editor itself is powered by <a href="http://codemirror.net/">CodeMirror</a>, a powerful text editor implemented using JavaScript. DevTools imports the CodeMirror editor into its own codebase and selectively enables various features which are in turn made available to any Chrome user.</p>

<p>When editing JavaScript (amongst other supported languages), the Sources Panel editor contains a number of utilities such as:</p>

<ul>
  <li><strong>Autocomplete suggestions: </strong>Receive suggestions as to the word you may be trying to type. These are based on existing written properties within the same file. For example, <code>document</code> is not suggested after typing in <code>docu</code> unless there is already at least one occurrence of the word <code>document</code> in the same file.</li>
  <li><strong>Search and replace:</strong> To open the search box, click <strong>Command-F</strong>. Matching results are outlined in the code in real time. Checking the <strong>Replace</strong> checkbox provides search and replace abilities.</li>
  <li><strong>Keyboard Shortcuts:</strong> Various shortcuts exist, similar to those found in code editors such as Sublime Text. For example, use <strong>Command-/</strong> to toggle a comment, <strong>Command-D</strong> to select the next word occurrence of the currently selected word, and many more as documented on the official Chrome Developer Tools shortcuts page.</li>
</ul>

<h4><strong>Live Editing JavaScript</strong></h4>

<p>The feature, better known as Live Edit, gives you the ability to edit a page's JavaScript code via DevTools and have the changes apply to the page immediately without a page refresh. There is no particular UI to use this; you simply rewrite a part of JavaScript code and press <strong>Command-S</strong> to save it.</p>

<p>How this works behind the scenes is explained below, but first, consider the following prerequisites (these are independant of Live Edit):</p>

<ol>
  <li>A page which uses <code class="inline">script.js</code> loads into Chrome via a web page.</li>
  <li><code class="inline">script.js</code> is parsed, evaluated, and compiled into machine code through the <a href="https://code.google.com/p/v8/">V8 JavaScript Engine</a>.</li>
</ol>

<p>Here's what happens behind the scenes of the Live Edit feature, considering the previous points:</p>

<ol>
  <li>You open <code class="inline">script.js</code> in the DevTools code editor. Assume there is a button on current web page. On button click, a click event listener executes an anonymous function.</li>
  <li>You modify the anonymous function to add a <code>console.log</code> statement and save the file.</li>
  <li>The raw text contents of <code class="inline">script.js</code> are injected back into the V8 engine for processing.</li>
  <li>Comparisons are made between the new <code class="inline">script.js</code> and the old one. Deletions, additions and modifications are stored.</li>
  <li>V8 compiles the modified JavaScript and patches <code class="inline">script.js</code> with the compiled changes.</li>
</ol>

<p>Live Edit works best with minor modifications rather than authoring entire JavaScript files for your app. Debug scenarios work well with Live Edit.</p>

<h4><strong>Workspaces</strong></h4>

<p>Workspaces is not a critical component of JavaScript debugging via the DevTools. However, depending on your requirements, it can speed up your debugging workflow. Workspaces is a feature of the DevTools which enables you to modify the contents of a folder on the file system by making code changes in the DevTools.</p>

<p>If you are browsing a project which is served locally though a web server, such as at <code>http://localhost:3000/</code> and the project exists on your file system at <code>~/development/project</code>, for example, you can teach DevTools about the mapping between the two and use the Live Edit capabilities with save-to-disk abilities. Workspaces enables the following workflow:</p>

<ol>
  <li>After you instruct your DevTools about the mapping between the page you are viewing and its source on your file system, you can view the source code in the <strong>Sources Panel</strong>.</li>
  <li>You encounter a JavaScript error so while debugging, you make a change in the <strong>Sources Panel</strong>.</li>
  <li>You save your change using <strong>Command-S</strong>.</li>
</ol>

<p>In step 3, the save overwrites the original source file.</p>

<h4><strong>Source Maps</strong></h4>

<p>Source Maps solve a common problem when dealing with source code that is processed or compiled into something else. Examples include:</p>

<ul>
  <li>JavaScript code which is minified and concatenated as part of a build system</li>
  <li>Ecmascript 6 code which is transpiled into ES5 code so that it is compatible with all modern browsers</li>
  <li>CoffeeScript code which gets compiled into JavaScript</li>
</ul>

<p>The problem is as follows: when debugging a processed version of the code, it can be hard to understand how your original source code maps onto what you are viewing during debugging. If you are getting an error in the DevTools console for a production website, you will typically end up having to debug a minified and concatenated version of JavaScript code, which bears little resemblance to the source files which you author.</p>

<p>A Source Map is a generated file produced as part of a compilation process which is available for the use cases listed earlier. DevTools can read a Source Map file to understand how a compiled file maps onto the original file.</p>

<p>The two code snippets (Source File—app.js and Transpiled file—compiled.js) demonstrate Source Map debugger-friendly code.</p>

<p><strong>Example 1. Source File—app.js</strong></p>

<pre class="brush: javascript">for (var element of [1, 2, 3]) {
  console.log(element);
}</pre>

<p>Note that the <code class="inline">app.js</code> source file uses an Ecmascript 6 compatible feature known as the Array iterator.</p>

<p><strong>Example 2. Transpiled File—compiled.js</strong></p>

<pre class="brush: javascript">"use strict";
for (var $__0 = [1, 2, 3][Symbol.iterator](),
$__1; !($__1 = $__0.next()).done; ) {
  var element = $__1.value;
  {
    console.log(element);
  }
}

//# sourceMappingURL=app.js.map</pre>

<p>Note that <code class="inline">compiled.js</code> is referenced by a script tag on an HTML page, along with the Traceur runtime, and finally is opened in a browser.</p>

<figure class="post_image">
  <img alt="compiledjs screenshot" src="https://s3.amazonaws.com/cms-assets.tutsplus.com/uploads/users/329/posts/22571/image/md-source-map-traceur.png"/>
</figure>

<p>Even the compiled JavaScript has the <code>console.log</code> statement on line 6. DevTools is able to show exactly where the<code>console.log</code> statement exists within the original source file (Source Map debugging), which is on line 2. Breakpoints work as expected. Behind the scenes, the compiled JavaScript is evaluated and executed, but DevTools is presenting a different asset in lieu of the browser evaluated version.</p>

<h4><strong>Snippets</strong></h4>

<p>The Snippets feature of the DevTools provides a quick way to write miscellaneous JavaScript code and execute it. All JavaScript executed via Snippets is run within the context of the current page. Executing a DevTools Snippet is similar to running a Bookmarklet on a page. You may find it preferable to write certain JavaScript within Snippets as opposed to the Console Panel for reasons related to a better code editing environment. Your snippets are saved within the Local Storage of the DevTools.</p>

<p>To use Snippets:</p>

<ol>
  <li>Ensure the left sidebar is visible within the <strong>Sources Panel </strong>and select the <strong>Snippets</strong> tab in the sidebar (alongside the "Sources" and "Content Scripts" tabs).</li>
  <li><strong>Right-click</strong> in the left sidebar and select <strong>New</strong> to create a new Snippet.</li>
  <li>Name your new Snippet.</li>
  <li>Write <code>console.log('Hello');</code> in the code editor.</li>
  <li>Press <strong>Command-Enter</strong> and notice the resulting output in the Console Panel.</li>
</ol>

<p>You can find a number of already-written snippets in this <a href="http://bgrins.github.io/devtools-snippets/">DevTools Snippets repository</a>.</p>

<p>That's it for Part 1 of a Modern Debugging Experience. In Part 2, we'll take a look at some debugging features and also a few extensions which can help with this. </p>