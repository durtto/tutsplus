<h1>Usando Polymer Para Criar Componentes Web</h1>

<p>Construir aplicações web modernas requer várias ferramentas. Entre elas temos os pré-processadores, bibliotecas JavaScript, ferramentas de testes e muito mais coisas. E, de acordo com que a complexidade dessas aplicações aumenta, também aumenta a amplitude de ferramentas e serviços necessários para administrá-los. Não seria ótimo se algumas delas fosse mais simples?</p>

<p>Os Componentes Web buscam melhorar algumas dessas complexidades, provendo uma maneira unificada para criar novos elementos que proveem funcionalidades ricas sem a necessidade de bibliotecas extras. Os componentes são compostos de quatro especificações diferentes (<a href="http://www.polymer-project.org/platform/custom-elements.html">Custom Elements</a>, <a href="http://www.polymer-project.org/docs/polymer/template.html" target="_self">Templates</a>, <a href="http://www.polymer-project.org/platform/shadow-dom.html">Shadow DOM</a> e <a href="http://www.polymer-project.org/platform/html-imports.html">HTML imports</a>) que estão sendo concretizados pela W3C. </p>

<p>Para suprir essa demanda e dar acesso aos desenvolvedores esse tipo de funcionalidade, hoje, o Google criou a biblioteca <a href="http://www.polymer-project.org/">Polymer</a> que serve como um conjunto de códigos que implementa essas especificações, trazendo a "promessa" dos Componentes Web para você, hoje. Aprendamos mais um pouco sobre ele.</p>

<h2>O Que É Polymer</h2>

<p>Como mencionei, a biblioteca Polymer é um conjunto de códigos que implementam as quatro especificações, e que ajuda você a criar Componentes Web para todos os maiores navegadores web modernos. Ele prover a base para definir, criar e renderizar elementos customizados, de forma simples, muito parecido com as tags HTML que você já está acostumado. O que quero dizer com isso é que ele ajuda a simplificar a forma como usamos componentes complexos ao: </p>

<ul>
<li>Encapsular grande parte da complexidade do código e estrutura;</li>
<li>Permitir que os desenvolvedores usem uma convenção de nomenclatura simples como as tags;</li>
<li>Prover um conjunto de elemento de interface do usuário pré-definidos, que podem ser usados e extendidos</li>
</ul>

<p>Mas, uma coisa importante a se lembrar, é que a própria Polymer tem sido desenvolvida com base na direção que as especificações tem tomado dentro da própria W3C, provendo, assim, uma base que evoluirá junto do padrão oficial.</p>

<p>O que essa biblioteca pode fazer, é permtir que criemos componentes reutilizáveis que funcionam como verdadeiros elementos DOM e, ao mesmo tempo, diminuir nossa dependência em relação ao JavaScript para manipulações complexas da DOM, na hora de renderizar resultos de interfaces de usuário ricas.</p>

<p>Eis um exemplo rápido, lá do site do Polymer. Digamos que quero renderizar um relógio funcional em meu site. Isso, geralmente, levaria uma boa carga de código JavaScript, mas, como Polymer, posso, simplesmente, usar a seguinte sintaxe:</p>

<pre class="brush: html">&lt;polymer-ui-clock&gt;&lt;/polymer-ui-clock&gt;</pre>

<p>Parece com a sintaxe HTML que estamos acostumados a usar e bem mais fácil de implementar, ler e manter, que códigos JavaScript. E o resultado final é parecido com isso:&nbsp;</p><figure class="post_image"><img alt="" src="https://s3.amazonaws.com/cms-assets.tutsplus.com/uploads/users/45/posts/20475/image/clock.png"></figure><p>E, já que ele é mais um elemnto na DOM, podemos estilizá-lo, usando CSS, dessa forma:</p>

<pre class="brush: css">      polymer-ui-clock {
        width: 320px;
        height: 320px;
        display: inline-block;
        background: url("../assets/glass.png") no-repeat;
        background-size: cover;
        border: 4px solid rgba(32, 32, 32, 0.3);
      }
</pre>

<p>Não é o melhor dos relógios, mas não essa a questão. O ponto é você poder customizar o componente ao seu gosto e poder reutilizá-lo através de uma sintaxe mais fácil e manutenível.</p>

<h2>Instalando o Polymer</h2>

<p>Há três formas de instalar e usar o Polymer:</p>

<ul>
<li>Usando o administrador de pacotes Bower (melhor forma)</li>
<li>Usando as bibliotecas hospedadas no <a href="http://cdnjs.com/">cdnjs</a> da Cloudfare</li>
<li>Instalando através do Git</li>
</ul>

<p>Das três maneiras, a mais fácil e recomendada é usar o <a href="http://bower.io/">Bower</a> porque, além de ser mais fácil, o Bower também administra quaisquer dependências que o Polymer tiver/precisar. Isso significa que se você escolher instalar algum elemento específico de interface do usuário que depende de algum outro, o Bower lidará com isso por você.</p>

<p>O Bower é instalado como um módulo do Node (NPM), então, você precisará ter o <a href="http://nodejs.org/">Node.js</a> instalado. Na linha de comando, digite o comando a seguir:</p>

<pre class="brush: bash">npm install -g bower
</pre>

<p>Isso deve baixar o Bower, direto da Listagem do NPM, e o instalará globalmente para você. Daqui, quaisquer instalações a partir do Bower, seguirão o segunte padrão:</p>

<pre class="brush: bash">bower install
</pre>

<p>No mínimo, você precisará instalar a plataforma e a fundação dos componentes do Polymer, já que eles provem o que é necessário para você criar e executar seus elementos customizados.</p><pre class="brush: bash">bower install --save Polymer/platform
bower install --save Polymer/polymer</pre>

<p>Você também pode usar o seguinte comado para obter o mesmo resultado:</p>

<pre class="brush: bash">bower install --save Polymer/platform Polymer/polymer
</pre>

<p>O Polymer vem com um conjunto pré-definido e rico de elementos que você pode utilizar imediatamente. São elementos de <a href="http://www.polymer-project.org/docs/elements/" target="_self">interface de usuário e alguns outros</a> que provêm várias funcionalidades, como:</p>

<ul>
<li>Animação</li>
<li>Acordeões</li>
<li>Layout de Grade (grids)</li>
<li>Funcionalidade AJAX</li>
<li>Menus</li>
<li>Abas</li>
</ul>

<p>E isso é só a ponta do <em>iceberg</em>. Há muito mais ali, com o código fonte disponível para servir como meio de aprendizado, bem como permitir você customizar as capacidades às suas necessidades.</p>

<p>Você tem a opção de instalar esses componentes. Você pode instalar tudo ou somente aquilo que você quiser usar. Para instalar tudo, digite e execute:</p>

<pre class="brush: bash">bower install Polymer/core-elements
bower install Polymer/polymer-ui-elements</pre>

<p>Esse é a forma mais simples para você que está aprendendo o Polymer, que permite analisar o que etá disponível na biblioteca.</p>

<p>Quando estiver familiarizado, você pode escolher a dedo os componentes que você quer usar, e instalá-los com esse comando:</p>

<pre class="brush: bash">bower install Polymer/polymer-ui-accordion
</pre>

<p>Essa é a beleza de usar o Bower. Cada componente vem com um arquivo de configuração, o <code>bower.json</code>, que define suas dependências. Assim, se você fosse instalar o componente <code>accordion</code>, olhando a configuração, podemos ver que ele depende do componente <code>polymer</code> base, bem como dos componentes <code>selector</code> e <code>collapsible</code>.</p>

<pre class="brush: javascript">{
  "name": "polymer-ui-accordion",
  "private": true,
  "dependencies": {
    "polymer": "Polymer/polymer#0.2.0",
    "polymer-selector": "Polymer/polymer-selector#0.2.0",
    "polymer-ui-collapsible": "Polymer/polymer-ui-collapsible#0.2.0"
  },
  "version": "0.2.0"
}
</pre>

<p>O ponto chave é você não se preocupar com isso, porque o Bower administra tudo isso por você. É por isso que o Bower é a ferramenta preferida para instalar o Polymer.</p>

<p>Instalá-lo através do Bower criará um diretório no seu projeto, chamado <code>bower_components</code>, que guardará todos os arquivos que o Polymer precisa.</p>

<h2>Criando Novo Elementos do Polymer</h2>

<p>O site do Polymer descreve muito bem o que é um elemento customizado:</p>

<p>“Elementos Customizados são a base das aplicações feitas com Polymer. Você criar aplicações ao juntar elementos customizados, seja os providos pelo Polymer, criados por você ou de elementos terceirizados.”</p>

<p>O Polymer nos permite criar nossos próprios elementos customizado, do zero, ou reutilizar outros elementos ao criar os nossos próprios. Fazemos isso, primeiro, criando um modelo do elemento customizado. Para todos os fins, esse modelo é uma combinação de HTML, CSS e JavaScript e inclui a funcionalidade que disponibilizaremos quando usarmos o elemento. Ele é baseado na <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/scripting-1.html#the-template-element">Especificação de Modelos (templates) HTML da WhatWG</a> que dará suporte nativo para modelos no lado do cliente.</p>

<p>Vejamos esse exemplo simples de um modelo do Polymer:</p>

<pre class="brush: html">&lt;link rel="import" href="../bower_components/polymer/polymer.html"&gt;

&lt;polymer-element name="lorem-element"&gt;
  &lt;template&gt;
    &lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.&lt;/p&gt;
  &lt;/template&gt;
&lt;/polymer-element&gt;</pre>

<p>Esse elemento permite você adicionar, facilmente, texto <em>Lorem Ipsum</em> em seu código, simplesmente usando a seguinte tag:</p>

<pre class="brush: html">&lt;lorem-element&gt;&lt;/lorem-element&gt;</pre>

<p>A primeira coisa que precisamos fazer é incluir o código base do Polymer, que a interface de programação (API) principal a permitir que definamos os Elementos Customizados:</p>

<pre class="brush: html">&lt;link rel="import" href="../bower_components/polymer/polymer.html"&gt;</pre>

<p>O próximo passo é definir o nome do novo elemento, usando a diretriz <code>polymer-element</code> do Polymer: </p>

<pre class="brush: html">&lt;polymer-element name="lorem-element"&gt;</pre>

<p>Nesse caso, nomeei meu novo elemento de <code>lorem-element</code>. O nome é um atributo obrigatório e deve conter um hífen (“-”). </p>

<p>Daí, usamos a diretriz <code>template</code> para envolver os código principal que comporá nosso elemento. Para esse simples exemplo, pego o texto Lorem Ipsum e o envolvo ao com tags de parágrafo.</p>

<p>Só isso! Meu elemento customizado está pronto e já posso utilizá-lo. </p>

<h2>Usando Seu Novo Elemento Polymer</h2>

<p>Tenha em mente que esse componente será importado por outras páginas em seu aplicativo web que precisarem utilizá-lo. Isso é possível porque o Polymer implementa a especificação do <em>HTML Imports</em>, que permite incluir e reutilizar documentos HTML em outros documentos HTML.</p>

<p>Primeiro, você precisará incluir o arquivo <code>platform.js</code> que provê o código necessário para simular as APIs nativas:</p>

<pre class="brush: html">&lt;script src="bower_components/platform/platform.js"&gt;&lt;/script&gt;</pre>

<p>Depois, precisaremos importar nosso elemento customizado em nossa página:</p>

<pre class="brush: html">&lt;link rel="import" href="lorem-element.html"&gt;</pre>

<p>Uma vez feito isso, nosso novo elemento customizado estará disponível, permitindo que façamos isso:</p>

<pre class="brush: html">&lt;div&gt;&lt;lorem-element&gt;&lt;/lorem-element&gt;&lt;/div&gt;</pre>

<p>Também poderemos a capacidade de estilizar completamente o elemento: </p>

<pre class="brush: html">&lt;style&gt;
      div { width: 300px;}
      lorem-element { font: bold 16px cursive;}
&lt;/style&gt;</pre>

<p>Esse é um exemplo bem básico. Vamos um pouco além, agora.</p>

<h2>Adicionando Mais Funcionalidades ao Elemento</h2>

<p>Se você lembrar, menciou como você pode fazer uso de elementos pré-existentes para aprimorar o seu próprio elemento. Vejamos como fazer isso.</p>

<p>Digamos que eu queira ter um elemento que fosse ao Reddit, buscasse informações sobre algumas <em>subreddits</em>. Poço fazer uso do componente Ajax, já existente, do Polymer, incluindo-o em meu elemento, dessa forma:</p>

<pre class="brush: html">&lt;link rel="import" href="../bower_components/polymer/polymer.html"&gt;
&lt;link rel="import" href="../bower_components/core-ajax/core-ajax.html"&gt;

&lt;polymer-element name="reddit-element"&gt;
  &lt;template&gt;
    &lt;core-ajax url="http://www.reddit.com//r/aww/about.json" auto response="{{resp}}"&gt;&lt;/core-ajax&gt;
    &lt;p&gt;{{resp.data.public_description}}&lt;/p&gt;
  &lt;/template&gt;
&lt;/polymer-element&gt; </pre>

<p>Perceba que estou importando o componente Ajax do Polymer e colocando-o no meu modelo. Isso facilita a referência ao meu novo elemento, o que torna as chamadas XHR para trazer os dados em formato JSON e usá-los para preencher minhas tags de parágrafo com a descrição pública do <em>subreddit</em>:</p>

<p>“Things that make you go AWW! Like puppies. And bunnies... and so on... A place for really cute pictures, videos and stories!”</p>

<p>A resposta foi retornada e o Polymer estabelece uma união de mão-dupla entre os dados e o modelo, que me permite usar os dados, envolvendo-os em chaves duplas, dessa forma <code>{{resp.data.public_description}}</code>.</p>

<p>Isso é legal, mas, na maioria das vezes, não fixaremos uma URL para um recurso específico. Nós aprimoraremos o nosso elemento, adicionando atributos a ele. Primeiro, precisamos atualizar a diretriz <code>polymer-element</code> para refletir os atributos que queremos em nosso elemento customizado:</p>

<pre class="brush: html">&lt;polymer-element name="reddit-element" attributes="subreddit"&gt;</pre>

<p>Nesse caso, quero poder passar o nome de um <em>subreddit</em> para o elemento e obter as respectivas informações dele. Posso, agora, modificar a chamada ao <code>polymer-ajax</code> para algo assim:</p>

<pre class="brush: html">&lt;core-ajax url="http://www.reddit.com//r/{{subreddit}}/about.json" auto response="{{resp}}"&gt;&lt;/core-ajax&gt;</pre>

<p>Perceba como uso as capacidades de união dos dados do Polymer para criar, dinamicamente, a URL, baseada no valor do atributo <code>{{subreddit}}</code>. Agora, podemos atualizar a referência ao elemento customizado, passando o <em>subreddit</em> que queremos:</p>

<pre class="brush: html">&lt;reddit-element subreddit="aww"&gt;&lt;/reddit-element&gt;</pre>

<p>A última coisa que faremos é garantir um valor padrão para o atributo, para evitar que o código lance algum erro. Faço isso adicionando o trecho a seguir ao modelo do meu elemento:</p>

<pre class="brush: html">  &lt;script&gt;
    Polymer('reddit-element', {
      subreddit: "aww"
    });
  &lt;/script&gt;</pre>

<p>Isso garante que sempre terei um valor padrão para o atributo público do meu elemento. Eis, aqui, mais ou menos como o código final deve ficar:</p>

<pre class="brush: html">&lt;link rel="import" href="../bower_components/polymer/polymer.html"&gt;
&lt;link rel="import" href="../bower_components/core-ajax/core-ajax.html"&gt;

&lt;polymer-element name="reddit-element" attributes="subreddit"&gt;
  &lt;template&gt;
    &lt;core-ajax url="http://www.reddit.com//r/{{subreddit}}/about.json" auto response="{{resp}}"&gt;&lt;/core-ajax&gt;
    &lt;p&gt;{{resp.data.public_description}}&lt;/p&gt;
  &lt;/template&gt;
  &lt;script&gt;
    Polymer('reddit-element', {
      // These default values are overridden
      // by the user's attribute values.
      subreddit: "aww"
    });
  &lt;/script&gt;
&lt;/polymer-element&gt; </pre>

<p>E há muito mais coisa que podemos fazer, como incluir manipuladores customizados de <em>callbacks</em>, manipulação de eventos, preparar <em>Observadores de Mutação</em> para processar as mudanças que ocorrerem no DOM e muito mais.</p>

<h2>O Futuro Está Aqui</h2>

<p>Os Componentes Web mudarão a forma como criamos aplicativos web e o Polymer tem nos permitido isso, hoje. Você, agora, é capaz de criar seus próprios elementos customizados e manuteníveis, próprios para as necessidades de suas aplicações. Esses componentes podem ser, facilmente, compartilhados, permitindo que outras equipes, ou mesmo a comunidade, compartilhem e se beneficiem desses blocos de funcionalidades encapsulados.</p>